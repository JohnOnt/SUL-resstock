GHG_base_RR_CFE$NewGasGHG<-data.frame(GasGHG=with(select(NewGasGHG_base_RR,Year,GasGHG),spline(Year,GasGHG,xout = 2020:2060)),method="spline()")[,2]
GHG_base_RR_CFE$OldElecGHG<-data.frame(ElecGHG=with(select(OldElecGHG_base_RR_CFE,Year,ElecGHG),spline(Year,ElecGHG,xout = 2020:2060)),method="spline()")[,2]
GHG_base_RR_CFE$NewElecGHG<-data.frame(ElecGHG=with(select(NewElecGHG_base_RR_CFE,Year,ElecGHG),spline(Year,ElecGHG,xout = 2020:2060)),method="spline()")[,2]
GHG_base_RR_CFE$OldElecGHG[1:6]<-GHG_base_RR_LREC$OldElecGHG[1:6] # 2020:2025 same as LRE
GHG_base_RR_CFE$NewElecGHG[1:6]<-GHG_base_RR_LREC$NewElecGHG[1:6] # 2020:2025 same as LRE
GHG_base_RR_CFE$OldElecGHG[16:41]<-GHG_base_RR_CFE$NewElecGHG[16:41]<-0
# calculation source emissions from fuel for base ER #########
rs_base_all_ER$NewCon<-0
rs_base_all_ER[rs_base_all_ER$Vintage.ACS %in% c("2020s","2030s","2040s","2050s"),]$NewCon<-1
rs_base_all_ER$OldCon<-0
rs_base_all_ER[rs_base_all_ER$NewCon==0,]$OldCon<-1
rs_base_all_ER[,c("Old_OilGHGkg_2020","Old_OilGHGkg_2025","Old_OilGHGkg_2030","Old_OilGHGkg_2035","Old_OilGHGkg_2040","Old_OilGHGkg_2045","Old_OilGHGkg_2050","Old_OilGHGkg_2055","Old_OilGHGkg_2060")]<-1000*
rs_base_all_ER$OldCon*(rs_base_all_ER$base_weight*rs_base_all_ER[,c("wbase_2020",  "wbase_2025", "wbase_2030", "wbase_2035", "wbase_2040", "wbase_2045", "wbase_2050", "wbase_2055", "wbase_2060")])*
(matrix(rep(rs_base_all_ER$Oil_GJ*GHGI_FO,9),nrow(rs_base_all_ER),9)+ matrix(rep(rs_base_all_ER$Prop_GJ*GHGI_LP,9),nrow(rs_base_all_ER),9))
rs_base_all_ER[,c("New_OilGHGkg_2020","New_OilGHGkg_2025","New_OilGHGkg_2030","New_OilGHGkg_2035","New_OilGHGkg_2040","New_OilGHGkg_2045","New_OilGHGkg_2050","New_OilGHGkg_2055","New_OilGHGkg_2060")]<-1000*
rs_base_all_ER$NewCon*(rs_base_all_ER$base_weight*rs_base_all_ER[,c("wbase_2020",  "wbase_2025", "wbase_2030", "wbase_2035", "wbase_2040", "wbase_2045", "wbase_2050", "wbase_2055", "wbase_2060")])*
(matrix(rep(rs_base_all_ER$Oil_GJ*GHGI_FO,9),nrow(rs_base_all_ER),9)+ matrix(rep(rs_base_all_ER$Prop_GJ*GHGI_LP,9),nrow(rs_base_all_ER),9))
rs_base_all_ER[,c("Old_GasGHGkg_2020","Old_GasGHGkg_2025","Old_GasGHGkg_2030","Old_GasGHGkg_2035","Old_GasGHGkg_2040","Old_GasGHGkg_2045","Old_GasGHGkg_2050","Old_GasGHGkg_2055","Old_GasGHGkg_2060")]<-1000*
rs_base_all_ER$OldCon*(rs_base_all_ER$base_weight*rs_base_all_ER[,c("wbase_2020",  "wbase_2025", "wbase_2030", "wbase_2035", "wbase_2040", "wbase_2045", "wbase_2050", "wbase_2055", "wbase_2060")])*
(matrix(rep(rs_base_all_ER$Gas_GJ*GHGI_NG,9),nrow(rs_base_all_ER),9))
rs_base_all_ER[,c("New_GasGHGkg_2020","New_GasGHGkg_2025","New_GasGHGkg_2030","New_GasGHGkg_2035","New_GasGHGkg_2040","New_GasGHGkg_2045","New_GasGHGkg_2050","New_GasGHGkg_2055","New_GasGHGkg_2060")]<-1000*
rs_base_all_ER$NewCon*(rs_base_all_ER$base_weight*rs_base_all_ER[,c("wbase_2020",  "wbase_2025", "wbase_2030", "wbase_2035", "wbase_2040", "wbase_2045", "wbase_2050", "wbase_2055", "wbase_2060")])*
(matrix(rep(rs_base_all_ER$Gas_GJ*GHGI_NG,9),nrow(rs_base_all_ER),9))
rs_base_all_ER[,c("Old_ElecGHGkg_2020","Old_ElecGHGkg_2025","Old_ElecGHGkg_2030","Old_ElecGHGkg_2035","Old_ElecGHGkg_2040","Old_ElecGHGkg_2045","Old_ElecGHGkg_2050","Old_ElecGHGkg_2055","Old_ElecGHGkg_2060")]<-1000*
rs_base_all_ER$OldCon*(rs_base_all_ER$base_weight*rs_base_all_ER[,c("wbase_2020",  "wbase_2025", "wbase_2030", "wbase_2035", "wbase_2040", "wbase_2045", "wbase_2050", "wbase_2055", "wbase_2060")])*
(rs_base_all_ER$Elec_GJ*rs_base_all_ER[,c("GHG_int_2020", "GHG_int_2025","GHG_int_2030","GHG_int_2035","GHG_int_2040","GHG_int_2045","GHG_int_2050","GHG_int_2055","GHG_int_2060")])
rs_base_all_ER[,c("New_ElecGHGkg_2020","New_ElecGHGkg_2025","New_ElecGHGkg_2030","New_ElecGHGkg_2035","New_ElecGHGkg_2040","New_ElecGHGkg_2045","New_ElecGHGkg_2050","New_ElecGHGkg_2055","New_ElecGHGkg_2060")]<-1000*
rs_base_all_ER$NewCon*(rs_base_all_ER$base_weight*rs_base_all_ER[,c("wbase_2020",  "wbase_2025", "wbase_2030", "wbase_2035", "wbase_2040", "wbase_2045", "wbase_2050", "wbase_2055", "wbase_2060")])*
(rs_base_all_ER$Elec_GJ*rs_base_all_ER[,c("GHG_int_2020", "GHG_int_2025","GHG_int_2030","GHG_int_2035","GHG_int_2040","GHG_int_2045","GHG_int_2050","GHG_int_2055","GHG_int_2060")])
# redefine these with new column numbers after introducing the new columns for CFE electricity
OldOilGHG_base_ER<-data.frame(Year=seq(2020,2060,5),OilGHG=colSums(rs_base_all_ER[,232:240])*1e-9)
NewOilGHG_base_ER<-data.frame(Year=seq(2020,2060,5),OilGHG=colSums(rs_base_all_ER[,241:249])*1e-9)
OldGasGHG_base_ER<-data.frame(Year=seq(2020,2060,5),GasGHG=colSums(rs_base_all_ER[,250:258])*1e-9)
NewGasGHG_base_ER<-data.frame(Year=seq(2020,2060,5),GasGHG=colSums(rs_base_all_ER[,259:267])*1e-9)
OldElecGHG_base_ER<-data.frame(Year=seq(2020,2060,5),ElecGHG=colSums(rs_base_all_ER[,268:276])*1e-9)
NewElecGHG_base_ER<-data.frame(Year=seq(2020,2060,5),ElecGHG=colSums(rs_base_all_ER[,277:285])*1e-9)
GHG_base_ER$OldOilGHG<-data.frame(OilGHG=with(select(OldOilGHG_base_ER,Year,OilGHG),spline(Year,OilGHG,xout = 2020:2060)),method="spline()")[,2]
GHG_base_ER$NewOilGHG<-data.frame(OilGHG=with(select(NewOilGHG_base_ER,Year,OilGHG),spline(Year,OilGHG,xout = 2020:2060)),method="spline()")[,2]
GHG_base_ER$OldGasGHG<-data.frame(GasGHG=with(select(OldGasGHG_base_ER,Year,GasGHG),spline(Year,GasGHG,xout = 2020:2060)),method="spline()")[,2]
GHG_base_ER$NewGasGHG<-data.frame(GasGHG=with(select(NewGasGHG_base_ER,Year,GasGHG),spline(Year,GasGHG,xout = 2020:2060)),method="spline()")[,2]
GHG_base_ER$OldElecGHG<-data.frame(ElecGHG=with(select(OldElecGHG_base_ER,Year,ElecGHG),spline(Year,ElecGHG,xout = 2020:2060)),method="spline()")[,2]
GHG_base_ER$NewElecGHG<-data.frame(ElecGHG=with(select(NewElecGHG_base_ER,Year,ElecGHG),spline(Year,ElecGHG,xout = 2020:2060)),method="spline()")[,2]
# repeat for LREC electricity
rs_base_all_ER[,c("Old_ElecGHGkg_2020_LRE","Old_ElecGHGkg_2025_LRE","Old_ElecGHGkg_2030_LRE","Old_ElecGHGkg_2035_LRE","Old_ElecGHGkg_2040_LRE","Old_ElecGHGkg_2045_LRE","Old_ElecGHGkg_2050_LRE","Old_ElecGHGkg_2055_LRE","Old_ElecGHGkg_2060_LRE")]<-1000*
rs_base_all_ER$OldCon*(rs_base_all_ER$base_weight*rs_base_all_ER[,c("wbase_2020",  "wbase_2025", "wbase_2030", "wbase_2035", "wbase_2040", "wbase_2045", "wbase_2050", "wbase_2055", "wbase_2060")])*
(rs_base_all_ER$Elec_GJ*rs_base_all_ER[,c("GHG_int_2020_LRE", "GHG_int_2025_LRE","GHG_int_2030_LRE","GHG_int_2035_LRE","GHG_int_2040_LRE","GHG_int_2045_LRE","GHG_int_2050_LRE","GHG_int_2055_LRE","GHG_int_2060_LRE")])
rs_base_all_ER[,c("New_ElecGHGkg_2020_LRE","New_ElecGHGkg_2025_LRE","New_ElecGHGkg_2030_LRE","New_ElecGHGkg_2035_LRE","New_ElecGHGkg_2040_LRE","New_ElecGHGkg_2045_LRE","New_ElecGHGkg_2050_LRE","New_ElecGHGkg_2055_LRE","New_ElecGHGkg_2060_LRE")]<-1000*
rs_base_all_ER$NewCon*(rs_base_all_ER$base_weight*rs_base_all_ER[,c("wbase_2020",  "wbase_2025", "wbase_2030", "wbase_2035", "wbase_2040", "wbase_2045", "wbase_2050", "wbase_2055", "wbase_2060")])*
(rs_base_all_ER$Elec_GJ*rs_base_all_ER[,c("GHG_int_2020_LRE", "GHG_int_2025_LRE","GHG_int_2030_LRE","GHG_int_2035_LRE","GHG_int_2040_LRE","GHG_int_2045_LRE","GHG_int_2050_LRE","GHG_int_2055_LRE","GHG_int_2060_LRE")])
OldElecGHG_base_ER_LREC<-data.frame(Year=seq(2020,2060,5),ElecGHG=colSums(rs_base_all_ER[,286:294])*1e-9)
NewElecGHG_base_ER_LREC<-data.frame(Year=seq(2020,2060,5),ElecGHG=colSums(rs_base_all_ER[,295:303])*1e-9)
GHG_base_ER_LREC$OldOilGHG<-data.frame(OilGHG=with(select(OldOilGHG_base_ER,Year,OilGHG),spline(Year,OilGHG,xout = 2020:2060)),method="spline()")[,2]
GHG_base_ER_LREC$NewOilGHG<-data.frame(OilGHG=with(select(NewOilGHG_base_ER,Year,OilGHG),spline(Year,OilGHG,xout = 2020:2060)),method="spline()")[,2]
GHG_base_ER_LREC$OldGasGHG<-data.frame(GasGHG=with(select(OldGasGHG_base_ER,Year,GasGHG),spline(Year,GasGHG,xout = 2020:2060)),method="spline()")[,2]
GHG_base_ER_LREC$NewGasGHG<-data.frame(GasGHG=with(select(NewGasGHG_base_ER,Year,GasGHG),spline(Year,GasGHG,xout = 2020:2060)),method="spline()")[,2]
GHG_base_ER_LREC$OldElecGHG<-data.frame(ElecGHG=with(select(OldElecGHG_base_ER_LREC,Year,ElecGHG),spline(Year,ElecGHG,xout = 2020:2060)),method="spline()")[,2]
GHG_base_ER_LREC$NewElecGHG<-data.frame(ElecGHG=with(select(NewElecGHG_base_ER_LREC,Year,ElecGHG),spline(Year,ElecGHG,xout = 2020:2060)),method="spline()")[,2]
# repeat for CFE electricity
rs_base_all_ER[,c("Old_ElecGHGkg_2020_CFE","Old_ElecGHGkg_2025_CFE","Old_ElecGHGkg_2030_CFE","Old_ElecGHGkg_2035_CFE","Old_ElecGHGkg_2040_CFE","Old_ElecGHGkg_2045_CFE","Old_ElecGHGkg_2050_CFE","Old_ElecGHGkg_2055_CFE","Old_ElecGHGkg_2060_CFE")]<-1000*
rs_base_all_ER$OldCon*(rs_base_all_ER$base_weight*rs_base_all_ER[,c("wbase_2020",  "wbase_2025", "wbase_2030", "wbase_2035", "wbase_2040", "wbase_2045", "wbase_2050", "wbase_2055", "wbase_2060")])*
(rs_base_all_ER$Elec_GJ*rs_base_all_ER[,c("GHG_int_2020_CFE", "GHG_int_2025_CFE","GHG_int_2030_CFE","GHG_int_2035_CFE","GHG_int_2040_CFE","GHG_int_2045_CFE","GHG_int_2050_CFE","GHG_int_2055_CFE","GHG_int_2060_CFE")])
rs_base_all_ER[,c("New_ElecGHGkg_2020_CFE","New_ElecGHGkg_2025_CFE","New_ElecGHGkg_2030_CFE","New_ElecGHGkg_2035_CFE","New_ElecGHGkg_2040_CFE","New_ElecGHGkg_2045_CFE","New_ElecGHGkg_2050_CFE","New_ElecGHGkg_2055_CFE","New_ElecGHGkg_2060_CFE")]<-1000*
rs_base_all_ER$NewCon*(rs_base_all_ER$base_weight*rs_base_all_ER[,c("wbase_2020",  "wbase_2025", "wbase_2030", "wbase_2035", "wbase_2040", "wbase_2045", "wbase_2050", "wbase_2055", "wbase_2060")])*
(rs_base_all_ER$Elec_GJ*rs_base_all_ER[,c("GHG_int_2020_CFE", "GHG_int_2025_CFE","GHG_int_2030_CFE","GHG_int_2035_CFE","GHG_int_2040_CFE","GHG_int_2045_CFE","GHG_int_2050_CFE","GHG_int_2055_CFE","GHG_int_2060_CFE")])
OldElecGHG_base_ER_CFE<-data.frame(Year=seq(2020,2060,5),ElecGHG=colSums(rs_base_all_ER[,304:312])*1e-9)
NewElecGHG_base_ER_CFE<-data.frame(Year=seq(2020,2060,5),ElecGHG=colSums(rs_base_all_ER[,313:321])*1e-9)
GHG_base_ER_CFE$OldOilGHG<-data.frame(OilGHG=with(select(OldOilGHG_base_ER,Year,OilGHG),spline(Year,OilGHG,xout = 2020:2060)),method="spline()")[,2]
GHG_base_ER_CFE$NewOilGHG<-data.frame(OilGHG=with(select(NewOilGHG_base_ER,Year,OilGHG),spline(Year,OilGHG,xout = 2020:2060)),method="spline()")[,2]
GHG_base_ER_CFE$OldGasGHG<-data.frame(GasGHG=with(select(OldGasGHG_base_ER,Year,GasGHG),spline(Year,GasGHG,xout = 2020:2060)),method="spline()")[,2]
GHG_base_ER_CFE$NewGasGHG<-data.frame(GasGHG=with(select(NewGasGHG_base_ER,Year,GasGHG),spline(Year,GasGHG,xout = 2020:2060)),method="spline()")[,2]
GHG_base_ER_CFE$OldElecGHG<-data.frame(ElecGHG=with(select(OldElecGHG_base_ER_CFE,Year,ElecGHG),spline(Year,ElecGHG,xout = 2020:2060)),method="spline()")[,2]
GHG_base_ER_CFE$NewElecGHG<-data.frame(ElecGHG=with(select(NewElecGHG_base_ER_CFE,Year,ElecGHG),spline(Year,ElecGHG,xout = 2020:2060)),method="spline()")[,2]
GHG_base_ER_CFE$OldElecGHG[1:6]<-GHG_base_ER_LREC$OldElecGHG[1:6] # 2020:2025 same as LRE
GHG_base_ER_CFE$NewElecGHG[1:6]<-GHG_base_ER_LREC$NewElecGHG[1:6] # 2020:2025 same as LRE
GHG_base_ER_CFE$OldElecGHG[16:41]<-GHG_base_ER_CFE$NewElecGHG[16:41]<-0
# calculation source emissions from fuel for hiDR RR ###########
rs_hiDR_all_RR$NewCon<-0
rs_hiDR_all_RR[rs_hiDR_all_RR$Vintage.ACS %in% c("2020s","2030s","2040s","2050s"),]$NewCon<-1
rs_hiDR_all_RR$OldCon<-0
rs_hiDR_all_RR[rs_hiDR_all_RR$NewCon==0,]$OldCon<-1
rs_hiDR_all_RR[,c("Old_OilGHGkg_2020","Old_OilGHGkg_2025","Old_OilGHGkg_2030","Old_OilGHGkg_2035","Old_OilGHGkg_2040","Old_OilGHGkg_2045","Old_OilGHGkg_2050","Old_OilGHGkg_2055","Old_OilGHGkg_2060")]<-1000*
rs_hiDR_all_RR$OldCon*(rs_hiDR_all_RR$base_weight*rs_hiDR_all_RR[,c("whiDR_2020",  "whiDR_2025", "whiDR_2030", "whiDR_2035", "whiDR_2040", "whiDR_2045", "whiDR_2050", "whiDR_2055", "whiDR_2060")])*
(matrix(rep(rs_hiDR_all_RR$Oil_GJ*GHGI_FO,9),nrow(rs_hiDR_all_RR),9)+ matrix(rep(rs_hiDR_all_RR$Prop_GJ*GHGI_LP,9),nrow(rs_hiDR_all_RR),9))
rs_hiDR_all_RR[,c("New_OilGHGkg_2020","New_OilGHGkg_2025","New_OilGHGkg_2030","New_OilGHGkg_2035","New_OilGHGkg_2040","New_OilGHGkg_2045","New_OilGHGkg_2050","New_OilGHGkg_2055","New_OilGHGkg_2060")]<-1000*
rs_hiDR_all_RR$NewCon*(rs_hiDR_all_RR$base_weight*rs_hiDR_all_RR[,c("whiDR_2020",  "whiDR_2025", "whiDR_2030", "whiDR_2035", "whiDR_2040", "whiDR_2045", "whiDR_2050", "whiDR_2055", "whiDR_2060")])*
(matrix(rep(rs_hiDR_all_RR$Oil_GJ*GHGI_FO,9),nrow(rs_hiDR_all_RR),9)+ matrix(rep(rs_hiDR_all_RR$Prop_GJ*GHGI_LP,9),nrow(rs_hiDR_all_RR),9))
rs_hiDR_all_RR[,c("Old_GasGHGkg_2020","Old_GasGHGkg_2025","Old_GasGHGkg_2030","Old_GasGHGkg_2035","Old_GasGHGkg_2040","Old_GasGHGkg_2045","Old_GasGHGkg_2050","Old_GasGHGkg_2055","Old_GasGHGkg_2060")]<-1000*
rs_hiDR_all_RR$OldCon*(rs_hiDR_all_RR$base_weight*rs_hiDR_all_RR[,c("whiDR_2020",  "whiDR_2025", "whiDR_2030", "whiDR_2035", "whiDR_2040", "whiDR_2045", "whiDR_2050", "whiDR_2055", "whiDR_2060")])*
(matrix(rep(rs_hiDR_all_RR$Gas_GJ*GHGI_NG,9),nrow(rs_hiDR_all_RR),9))
rs_hiDR_all_RR[,c("New_GasGHGkg_2020","New_GasGHGkg_2025","New_GasGHGkg_2030","New_GasGHGkg_2035","New_GasGHGkg_2040","New_GasGHGkg_2045","New_GasGHGkg_2050","New_GasGHGkg_2055","New_GasGHGkg_2060")]<-1000*
rs_hiDR_all_RR$NewCon*(rs_hiDR_all_RR$base_weight*rs_hiDR_all_RR[,c("whiDR_2020",  "whiDR_2025", "whiDR_2030", "whiDR_2035", "whiDR_2040", "whiDR_2045", "whiDR_2050", "whiDR_2055", "whiDR_2060")])*
(matrix(rep(rs_hiDR_all_RR$Gas_GJ*GHGI_NG,9),nrow(rs_hiDR_all_RR),9))
rs_hiDR_all_RR[,c("Old_ElecGHGkg_2020","Old_ElecGHGkg_2025","Old_ElecGHGkg_2030","Old_ElecGHGkg_2035","Old_ElecGHGkg_2040","Old_ElecGHGkg_2045","Old_ElecGHGkg_2050","Old_ElecGHGkg_2055","Old_ElecGHGkg_2060")]<-1000*
rs_hiDR_all_RR$OldCon*(rs_hiDR_all_RR$base_weight*rs_hiDR_all_RR[,c("whiDR_2020",  "whiDR_2025", "whiDR_2030", "whiDR_2035", "whiDR_2040", "whiDR_2045", "whiDR_2050", "whiDR_2055", "whiDR_2060")])*
(rs_hiDR_all_RR$Elec_GJ*rs_hiDR_all_RR[,c("GHG_int_2020", "GHG_int_2025","GHG_int_2030","GHG_int_2035","GHG_int_2040","GHG_int_2045","GHG_int_2050","GHG_int_2055","GHG_int_2060")])
rs_hiDR_all_RR[,c("New_ElecGHGkg_2020","New_ElecGHGkg_2025","New_ElecGHGkg_2030","New_ElecGHGkg_2035","New_ElecGHGkg_2040","New_ElecGHGkg_2045","New_ElecGHGkg_2050","New_ElecGHGkg_2055","New_ElecGHGkg_2060")]<-1000*
rs_hiDR_all_RR$NewCon*(rs_hiDR_all_RR$base_weight*rs_hiDR_all_RR[,c("whiDR_2020",  "whiDR_2025", "whiDR_2030", "whiDR_2035", "whiDR_2040", "whiDR_2045", "whiDR_2050", "whiDR_2055", "whiDR_2060")])*
(rs_hiDR_all_RR$Elec_GJ*rs_hiDR_all_RR[,c("GHG_int_2020", "GHG_int_2025","GHG_int_2030","GHG_int_2035","GHG_int_2040","GHG_int_2045","GHG_int_2050","GHG_int_2055","GHG_int_2060")])
OldOilGHG_hiDR_RR<-data.frame(Year=seq(2020,2060,5),OilGHG=colSums(rs_hiDR_all_RR[,232:240])*1e-9)
NewOilGHG_hiDR_RR<-data.frame(Year=seq(2020,2060,5),OilGHG=colSums(rs_hiDR_all_RR[,241:249])*1e-9)
OldGasGHG_hiDR_RR<-data.frame(Year=seq(2020,2060,5),GasGHG=colSums(rs_hiDR_all_RR[,250:258])*1e-9)
NewGasGHG_hiDR_RR<-data.frame(Year=seq(2020,2060,5),GasGHG=colSums(rs_hiDR_all_RR[,259:267])*1e-9)
OldElecGHG_hiDR_RR<-data.frame(Year=seq(2020,2060,5),ElecGHG=colSums(rs_hiDR_all_RR[,268:276])*1e-9)
NewElecGHG_hiDR_RR<-data.frame(Year=seq(2020,2060,5),ElecGHG=colSums(rs_hiDR_all_RR[,277:285])*1e-9)
GHG_hiDR_RR$OldOilGHG<-data.frame(OilGHG=with(select(OldOilGHG_hiDR_RR,Year,OilGHG),spline(Year,OilGHG,xout = 2020:2060)),method="spline()")[,2]
GHG_hiDR_RR$NewOilGHG<-data.frame(OilGHG=with(select(NewOilGHG_hiDR_RR,Year,OilGHG),spline(Year,OilGHG,xout = 2020:2060)),method="spline()")[,2]
GHG_hiDR_RR$OldGasGHG<-data.frame(GasGHG=with(select(OldGasGHG_hiDR_RR,Year,GasGHG),spline(Year,GasGHG,xout = 2020:2060)),method="spline()")[,2]
GHG_hiDR_RR$NewGasGHG<-data.frame(GasGHG=with(select(NewGasGHG_hiDR_RR,Year,GasGHG),spline(Year,GasGHG,xout = 2020:2060)),method="spline()")[,2]
GHG_hiDR_RR$OldElecGHG<-data.frame(ElecGHG=with(select(OldElecGHG_hiDR_RR,Year,ElecGHG),spline(Year,ElecGHG,xout = 2020:2060)),method="spline()")[,2]
GHG_hiDR_RR$NewElecGHG<-data.frame(ElecGHG=with(select(NewElecGHG_hiDR_RR,Year,ElecGHG),spline(Year,ElecGHG,xout = 2020:2060)),method="spline()")[,2]
# repeat for LREC electricity
rs_hiDR_all_RR[,c("Old_ElecGHGkg_2020_LRE","Old_ElecGHGkg_2025_LRE","Old_ElecGHGkg_2030_LRE","Old_ElecGHGkg_2035_LRE","Old_ElecGHGkg_2040_LRE","Old_ElecGHGkg_2045_LRE","Old_ElecGHGkg_2050_LRE","Old_ElecGHGkg_2055_LRE","Old_ElecGHGkg_2060_LRE")]<-1000*
rs_hiDR_all_RR$OldCon*(rs_hiDR_all_RR$base_weight*rs_hiDR_all_RR[,c("whiDR_2020",  "whiDR_2025", "whiDR_2030", "whiDR_2035", "whiDR_2040", "whiDR_2045", "whiDR_2050", "whiDR_2055", "whiDR_2060")])*
(rs_hiDR_all_RR$Elec_GJ*rs_hiDR_all_RR[,c("GHG_int_2020_LRE", "GHG_int_2025_LRE","GHG_int_2030_LRE","GHG_int_2035_LRE","GHG_int_2040_LRE","GHG_int_2045_LRE","GHG_int_2050_LRE","GHG_int_2055_LRE","GHG_int_2060_LRE")])
rs_hiDR_all_RR[,c("New_ElecGHGkg_2020_LRE","New_ElecGHGkg_2025_LRE","New_ElecGHGkg_2030_LRE","New_ElecGHGkg_2035_LRE","New_ElecGHGkg_2040_LRE","New_ElecGHGkg_2045_LRE","New_ElecGHGkg_2050_LRE","New_ElecGHGkg_2055_LRE","New_ElecGHGkg_2060_LRE")]<-1000*
rs_hiDR_all_RR$NewCon*(rs_hiDR_all_RR$base_weight*rs_hiDR_all_RR[,c("whiDR_2020",  "whiDR_2025", "whiDR_2030", "whiDR_2035", "whiDR_2040", "whiDR_2045", "whiDR_2050", "whiDR_2055", "whiDR_2060")])*
(rs_hiDR_all_RR$Elec_GJ*rs_hiDR_all_RR[,c("GHG_int_2020_LRE", "GHG_int_2025_LRE","GHG_int_2030_LRE","GHG_int_2035_LRE","GHG_int_2040_LRE","GHG_int_2045_LRE","GHG_int_2050_LRE","GHG_int_2055_LRE","GHG_int_2060_LRE")])
OldElecGHG_hiDR_RR_LREC<-data.frame(Year=seq(2020,2060,5),ElecGHG=colSums(rs_hiDR_all_RR[,286:294])*1e-9)
NewElecGHG_hiDR_RR_LREC<-data.frame(Year=seq(2020,2060,5),ElecGHG=colSums(rs_hiDR_all_RR[,295:303])*1e-9)
GHG_hiDR_RR_LREC$OldOilGHG<-data.frame(OilGHG=with(select(OldOilGHG_hiDR_RR,Year,OilGHG),spline(Year,OilGHG,xout = 2020:2060)),method="spline()")[,2]
GHG_hiDR_RR_LREC$NewOilGHG<-data.frame(OilGHG=with(select(NewOilGHG_hiDR_RR,Year,OilGHG),spline(Year,OilGHG,xout = 2020:2060)),method="spline()")[,2]
GHG_hiDR_RR_LREC$OldGasGHG<-data.frame(GasGHG=with(select(OldGasGHG_hiDR_RR,Year,GasGHG),spline(Year,GasGHG,xout = 2020:2060)),method="spline()")[,2]
GHG_hiDR_RR_LREC$NewGasGHG<-data.frame(GasGHG=with(select(NewGasGHG_hiDR_RR,Year,GasGHG),spline(Year,GasGHG,xout = 2020:2060)),method="spline()")[,2]
GHG_hiDR_RR_LREC$OldElecGHG<-data.frame(ElecGHG=with(select(OldElecGHG_hiDR_RR_LREC,Year,ElecGHG),spline(Year,ElecGHG,xout = 2020:2060)),method="spline()")[,2]
GHG_hiDR_RR_LREC$NewElecGHG<-data.frame(ElecGHG=with(select(NewElecGHG_hiDR_RR_LREC,Year,ElecGHG),spline(Year,ElecGHG,xout = 2020:2060)),method="spline()")[,2]
# repeat for CFE electricity
rs_hiDR_all_RR[,c("Old_ElecGHGkg_2020_CFE","Old_ElecGHGkg_2025_CFE","Old_ElecGHGkg_2030_CFE","Old_ElecGHGkg_2035_CFE","Old_ElecGHGkg_2040_CFE","Old_ElecGHGkg_2045_CFE","Old_ElecGHGkg_2050_CFE","Old_ElecGHGkg_2055_CFE","Old_ElecGHGkg_2060_CFE")]<-1000*
rs_hiDR_all_RR$OldCon*(rs_hiDR_all_RR$base_weight*rs_hiDR_all_RR[,c("whiDR_2020",  "whiDR_2025", "whiDR_2030", "whiDR_2035", "whiDR_2040", "whiDR_2045", "whiDR_2050", "whiDR_2055", "whiDR_2060")])*
(rs_hiDR_all_RR$Elec_GJ*rs_hiDR_all_RR[,c("GHG_int_2020_CFE", "GHG_int_2025_CFE","GHG_int_2030_CFE","GHG_int_2035_CFE","GHG_int_2040_CFE","GHG_int_2045_CFE","GHG_int_2050_CFE","GHG_int_2055_CFE","GHG_int_2060_CFE")])
rs_hiDR_all_RR[,c("New_ElecGHGkg_2020_CFE","New_ElecGHGkg_2025_CFE","New_ElecGHGkg_2030_CFE","New_ElecGHGkg_2035_CFE","New_ElecGHGkg_2040_CFE","New_ElecGHGkg_2045_CFE","New_ElecGHGkg_2050_CFE","New_ElecGHGkg_2055_CFE","New_ElecGHGkg_2060_CFE")]<-1000*
rs_hiDR_all_RR$NewCon*(rs_hiDR_all_RR$base_weight*rs_hiDR_all_RR[,c("whiDR_2020",  "whiDR_2025", "whiDR_2030", "whiDR_2035", "whiDR_2040", "whiDR_2045", "whiDR_2050", "whiDR_2055", "whiDR_2060")])*
(rs_hiDR_all_RR$Elec_GJ*rs_hiDR_all_RR[,c("GHG_int_2020_CFE", "GHG_int_2025_CFE","GHG_int_2030_CFE","GHG_int_2035_CFE","GHG_int_2040_CFE","GHG_int_2045_CFE","GHG_int_2050_CFE","GHG_int_2055_CFE","GHG_int_2060_CFE")])
OldElecGHG_hiDR_RR_CFE<-data.frame(Year=seq(2020,2060,5),ElecGHG=colSums(rs_hiDR_all_RR[,304:312])*1e-9)
NewElecGHG_hiDR_RR_CFE<-data.frame(Year=seq(2020,2060,5),ElecGHG=colSums(rs_hiDR_all_RR[,313:321])*1e-9)
GHG_hiDR_RR_CFE$OldOilGHG<-data.frame(OilGHG=with(select(OldOilGHG_hiDR_RR,Year,OilGHG),spline(Year,OilGHG,xout = 2020:2060)),method="spline()")[,2]
GHG_hiDR_RR_CFE$NewOilGHG<-data.frame(OilGHG=with(select(NewOilGHG_hiDR_RR,Year,OilGHG),spline(Year,OilGHG,xout = 2020:2060)),method="spline()")[,2]
GHG_hiDR_RR_CFE$OldGasGHG<-data.frame(GasGHG=with(select(OldGasGHG_hiDR_RR,Year,GasGHG),spline(Year,GasGHG,xout = 2020:2060)),method="spline()")[,2]
GHG_hiDR_RR_CFE$NewGasGHG<-data.frame(GasGHG=with(select(NewGasGHG_hiDR_RR,Year,GasGHG),spline(Year,GasGHG,xout = 2020:2060)),method="spline()")[,2]
GHG_hiDR_RR_CFE$OldElecGHG<-data.frame(ElecGHG=with(select(OldElecGHG_hiDR_RR_CFE,Year,ElecGHG),spline(Year,ElecGHG,xout = 2020:2060)),method="spline()")[,2]
GHG_hiDR_RR_CFE$NewElecGHG<-data.frame(ElecGHG=with(select(NewElecGHG_hiDR_RR_CFE,Year,ElecGHG),spline(Year,ElecGHG,xout = 2020:2060)),method="spline()")[,2]
GHG_hiDR_RR_CFE$OldElecGHG[1:6]<-GHG_hiDR_RR_LREC$OldElecGHG[1:6] # 2020:2025 same as LRE
GHG_hiDR_RR_CFE$NewElecGHG[1:6]<-GHG_hiDR_RR_LREC$NewElecGHG[1:6] # 2020:2025 same as LRE
GHG_hiDR_RR_CFE$OldElecGHG[16:41]<-GHG_hiDR_RR_CFE$NewElecGHG[16:41]<-0
# calculate relative changes in emissiosn from difference sources, can skip past this bit ###### until defining stock segments
GHG_base_RR$EmGHG_pc<-GHG_base_RR$EmGHG/GHG_base_RR$EmGHG[1]
GHG_base_RR$TotGHG_pc<-GHG_base_RR$TotGHG/GHG_base_RR$TotGHG[1]
GHG_base_RR$OilGHG_pc<-rowSums(GHG_base_RR[,c("OldOilGHG","NewOilGHG")])/GHG_base_RR$OldOilGHG[1]
GHG_base_RR$GasGHG_pc<-rowSums(GHG_base_RR[,c("OldGasGHG","NewGasGHG")])/GHG_base_RR$OldGasGHG[1]
GHG_base_RR$ElecGHG_pc<-rowSums(GHG_base_RR[,c("OldElecGHG","NewElecGHG")])/GHG_base_RR$OldElecGHG[1]
GHG_base_RR$EmGHG_pc_tot<-GHG_base_RR$EmGHG/GHG_base_RR$TotGHG
GHG_base_RR_LREC$EmGHG_pc<-GHG_base_RR_LREC$EmGHG/GHG_base_RR_LREC$EmGHG[1]
GHG_base_RR_LREC$TotGHG_pc<-GHG_base_RR_LREC$TotGHG/GHG_base_RR_LREC$TotGHG[1]
GHG_base_RR_LREC$OilGHG_pc<-rowSums(GHG_base_RR_LREC[,c("OldOilGHG","NewOilGHG")])/GHG_base_RR_LREC$OldOilGHG[1]
GHG_base_RR_LREC$GasGHG_pc<-rowSums(GHG_base_RR_LREC[,c("OldGasGHG","NewGasGHG")])/GHG_base_RR_LREC$OldGasGHG[1]
GHG_base_RR_LREC$ElecGHG_pc<-rowSums(GHG_base_RR_LREC[,c("OldElecGHG","NewElecGHG")])/GHG_base_RR_LREC$OldElecGHG[1]
GHG_base_RR_LREC$EmGHG_pc_tot<-GHG_base_RR_LREC$EmGHG/GHG_base_RR_LREC$TotGHG
GHG_hiDR_RR$EmGHG_pc<-GHG_hiDR_RR$EmGHG/GHG_hiDR_RR$EmGHG[1]
GHG_hiDR_RR$TotGHG_pc<-GHG_hiDR_RR$TotGHG/GHG_hiDR_RR$TotGHG[1]
GHG_hiDR_RR$OilGHG_pc<-rowSums(GHG_hiDR_RR[,c("OldOilGHG","NewOilGHG")])/GHG_hiDR_RR$OldOilGHG[1]
GHG_hiDR_RR$GasGHG_pc<-rowSums(GHG_hiDR_RR[,c("OldGasGHG","NewGasGHG")])/GHG_hiDR_RR$OldGasGHG[1]
GHG_hiDR_RR$ElecGHG_pc<-rowSums(GHG_hiDR_RR[,c("OldElecGHG","NewElecGHG")])/GHG_hiDR_RR$OldElecGHG[1]
GHG_hiDR_RR$EmGHG_pc_tot<-GHG_hiDR_RR$EmGHG/GHG_hiDR_RR$TotGHG
GHG_hiDR_RR_LREC$EmGHG_pc<-GHG_hiDR_RR_LREC$EmGHG/GHG_hiDR_RR_LREC$EmGHG[1]
GHG_hiDR_RR_LREC$TotGHG_pc<-GHG_hiDR_RR_LREC$TotGHG/GHG_hiDR_RR_LREC$TotGHG[1]
GHG_hiDR_RR_LREC$OilGHG_pc<-rowSums(GHG_hiDR_RR_LREC[,c("OldOilGHG","NewOilGHG")])/GHG_hiDR_RR_LREC$OldOilGHG[1]
GHG_hiDR_RR_LREC$GasGHG_pc<-rowSums(GHG_hiDR_RR_LREC[,c("OldGasGHG","NewGasGHG")])/GHG_hiDR_RR_LREC$OldGasGHG[1]
GHG_hiDR_RR_LREC$ElecGHG_pc<-rowSums(GHG_hiDR_RR_LREC[,c("OldElecGHG","NewElecGHG")])/GHG_hiDR_RR_LREC$OldElecGHG[1]
GHG_hiDR_RR_LREC$EmGHG_pc_tot<-GHG_hiDR_RR_LREC$EmGHG/GHG_hiDR_RR_LREC$TotGHG
rs_base_all_RR$Type3<-"MF"
rs_base_all_RR[rs_base_all_RR$Geometry.Building.Type.RECS=="Single-Family Attached" | rs_base_all_RR$Geometry.Building.Type.RECS=="Single-Family Detached",]$Type3<-"SF"
rs_base_all_RR[rs_base_all_RR$Geometry.Building.Type.RECS=="Mobile Home",]$Type3<-"MH"
EI_base_RR20<-1000*tapply(rs_base_all_RR$Tot_GJ*rs_base_all_RR$base_weight*rs_base_all_RR$wbase_2020,list(rs_base_all_RR$Type3,rs_base_all_RR$Vintage),sum)/
(tapply(rs_base_all_RR$floor_area_lighting_ft_2*rs_base_all_RR$base_weight*rs_base_all_RR$wbase_2020,list(rs_base_all_RR$Type3,rs_base_all_RR$Vintage),sum)/10.765)
EI_base_RR60<-1000*tapply(rs_base_all_RR$Tot_GJ*rs_base_all_RR$base_weight*rs_base_all_RR$wbase_2060,list(rs_base_all_RR$Type3,rs_base_all_RR$Vintage),sum)/
(tapply(rs_base_all_RR$floor_area_lighting_ft_2*rs_base_all_RR$base_weight*rs_base_all_RR$wbase_2060,list(rs_base_all_RR$Type3,rs_base_all_RR$Vintage),sum)/10.765)
rs_base_all_AR$Type3<-"MF"
rs_base_all_AR[rs_base_all_AR$Geometry.Building.Type.RECS=="Single-Family Attached" | rs_base_all_AR$Geometry.Building.Type.RECS=="Single-Family Detached",]$Type3<-"SF"
rs_base_all_AR[rs_base_all_AR$Geometry.Building.Type.RECS=="Mobile Home",]$Type3<-"MH"
rs_base_all_AR$NewCon<-0
rs_base_all_AR[rs_base_all_AR$Vintage.ACS %in% c("2020s","2030s","2040s","2050s"),]$NewCon<-1
rs_base_all_AR$OldCon<-0
rs_base_all_AR[rs_base_all_AR$NewCon==0,]$OldCon<-1
EI_base_AR60<-1000*tapply(rs_base_all_AR$Tot_GJ*rs_base_all_AR$base_weight*rs_base_all_AR$wbase_2060,list(rs_base_all_AR$Type3,rs_base_all_AR$Vintage),sum)/
(tapply(rs_base_all_AR$floor_area_lighting_ft_2*rs_base_all_AR$base_weight*rs_base_all_AR$wbase_2060,list(rs_base_all_AR$Type3,rs_base_all_AR$Vintage),sum)/10.765)
rs_base_all_ER$Type3<-"MF"
rs_base_all_ER[rs_base_all_ER$Geometry.Building.Type.RECS=="Single-Family Attached" | rs_base_all_ER$Geometry.Building.Type.RECS=="Single-Family Detached",]$Type3<-"SF"
rs_base_all_ER[rs_base_all_ER$Geometry.Building.Type.RECS=="Mobile Home",]$Type3<-"MH"
rs_base_all_ER$NewCon<-0
rs_base_all_ER[rs_base_all_ER$Vintage.ACS %in% c("2020s","2030s","2040s","2050s"),]$NewCon<-1
rs_base_all_ER$OldCon<-0
rs_base_all_ER[rs_base_all_ER$NewCon==0,]$OldCon<-1
EI_base_ER60<-1000*tapply(rs_base_all_ER$Tot_GJ*rs_base_all_ER$base_weight*rs_base_all_ER$wbase_2060,list(rs_base_all_ER$Type3,rs_base_all_ER$Vintage),sum)/
(tapply(rs_base_all_ER$floor_area_lighting_ft_2*rs_base_all_ER$base_weight*rs_base_all_ER$wbase_2060,list(rs_base_all_ER$Type3,rs_base_all_ER$Vintage),sum)/10.765)
fn<-"../Supplementary_results_new/EI.xlsx"
wb<-createWorkbook()
addWorksheet(wb, "base_RR_2020")
writeData(wb, "base_RR_2020", EI_base_RR20)
addWorksheet(wb, "base_RR_2060")
writeData(wb, "base_RR_2060", EI_base_RR60)
addWorksheet(wb, "base_AR_2060")
writeData(wb, "base_AR_2060", EI_base_AR60)
addWorksheet(wb, "base_ER_2060")
writeData(wb, "base_ER_2060", EI_base_ER60)
saveWorkbook(wb,file = fn,overwrite = TRUE)
View(EI_base_RR60)
## modelling of efficiency and technology upgrade scenarios to existing pre-2020 units
# Peter Berrill Jan 18 2020
rm(list=ls()) # clear workspace i.e. remove saved variables
cat("\014") # clear console
library(dplyr)
library(ggplot2)
library(RColorBrewer)
library(readr)
library(reshape2)
setwd("~/Yale Courses/Research/Final Paper/resstock_projections/projection_scripts")
load('../../StockModelCode/rencombs.RData') # produced by older version of this script. Combinations of heat fuel/efficiencies, water heat fuel/efficiencies, cooling efficiencies, insulation types
rs<-read.csv("../scen_bscsv/bs2020_180k.csv") # load in most recent sample of 2020 housing stock
nms<-names(rs) # see which columns can be removed, none until after the RS simulations have been done
# create columns for indicating the year of the most recent renovation
rs$last_ctren_none<-rs$last_ctren_room<-rs$last_hren<-rs$last_cren<-rs$last_wren<-rs$last_iren<-0
# create columns for indicating the probability of getting renovated
rs$pi<-rs$pw<-rs$pc<-rs$ph<-rs$pctnone<-rs$pctroom<-0  # probability of renovating insulation (pi), water heater (pw), cooling equipment (pc), heating equipment (ph), changing cooling type (pctnone, pctroom)
# create columns to make note of renovations which actually make no change (e.g. because max eff level has already been reached).
# These will be turned to zero if a renovation actually involves no change
rs$change_hren<-rs$change_wren<-rs$change_iren<-rs$change_cren<-0 # note here if a renovation makes any change
rscn<-names(rs)
rs$Heating.Fuel_Efficiency<-paste(rs$Heating.Fuel,rs$HVAC.Heating.Efficiency,sep = "_")
# hfeff types pre-loaded in rencombs
phfe<-matrix(0,length(hfeff_types),length(hfeff_types)) # probability of increasing heating fuel efficiency. Define the actual values later. changes to HP will need to be also reflected in the HVAC Heating Type column
colnames(phfe)<-rownames(phfe)<-hfeff_types
# adjust heat fuel switches to reflect higher electrification, 0 oil, and much lower gas, approximately half of original amount
# NorthEast, in the Northeast, the move away from gas is the slowest, due to higher priced electricity
pfuel_all[,"Electricity","NE"]<-c(0.75,0.1,0.115,0,0,0.035) # switches to gas become approximately half of original
pfuel_all[,"Electricity HP","NE"]<-c(0,1,0,0,0,0) # all heat pumps stay as HP
pfuel_all[,"Gas","NE"]<-c(0.02,0.08,0.9,0,0,0) # 8% of gas becomes el HP (as opposed to 0)
pfuel_all[,"Oil","NE"]<-c(0.1,0.2,0.15,0.5,0,0.05) # much quicker scaledown of oil, 20% becomes el HP. Only 50% (as opposed to 77%) remains as oil
pfuel_all[,"Propane","NE"]<-c(0.02,0.08,0.1,0,0,0.8) # 8% of lpg becomes el HP, less remains as lpg or converts to gas
# MidWest, similar rates as West, but a little bit slower i
pfuel_all[,"Electricity","MW"]<-c(0.7,0.2,0.09,0,0,0.01) # Faster shift to el HP, smaller role for gas, about half of original
pfuel_all[,"Electricity HP","MW"]<-c(0,1,0,0,0,0) # all heat pumps stay as HP
pfuel_all[,"Gas","MW"]<-c(0.025,0.1,0.875,0,0,0) # 10% of gas becomes el HP (as opposed to 0.5%)
pfuel_all[,"Oil","MW"]<-c(0.15,0.35,0.35,0,0,0.15) # no oil is replaced with oil, large role for HP
pfuel_all[,"Propane","MW"]<-c(0.025,0.1,0.125,0,0,0.75) # 10% of lpg becomes el HP
# South,  highest rate of electrification here.
pfuel_all[,"Electricity","S"]<-c(0.75,0.25,0,0,0,0) # bigger role for el HP, no elec -> gas
pfuel_all[,"Electricity HP","S"]<-c(0,1,0,0,0,0) # all heat pumps stay as HP
pfuel_all[,"Gas","S"]<-c(0.12,0.13,0.75,0,0,0) # 13% of gas becomes el HP, 12% el Res
pfuel_all[,"Oil","S"]<-c(0.35,0.55,0.1,0,0,0) # no oil is replaced with oil, very large role for HP
pfuel_all[,"Propane","S"]<-c(0.25,0.15,0.1,0,0,0.5) # much of propane is replaced with electricity
# West, similar rates as MidWest, but a little bit faster
pfuel_all[,"Electricity","W"]<-c(0.75,0.2,0.05,0,0,0.00) # much bigger role for el HP, small switching to gas
pfuel_all[,"Electricity HP","W"]<-c(0,1,0,0,0,0) # all heat pumps stay as HP
pfuel_all[,"Gas","W"]<-c(0.1,0.1,0.8,0,0,0) # 10% of gas becomes el HP and el Res
pfuel_all[,"Oil","W"]<-c(0.25,0.5,0.25,0,0,0) # half of oil becomes el HP. none remains oil
pfuel_all[,"Propane","W"]<-c(0.25,0.25,0.25,0,0,0.25) # propane split evenly between el, el HP, gas, propane
load("~/Yale Courses/Research/US Housing/AHS/RenovationStats_new.RData") # produced by script AHS_new_ren2.R
load('../../StockModelCode/rencombs.RData') # produced by older version of this script. Combinations of heat fuel/efficiencies, water heat fuel/efficiencies, cooling efficiencies, insulation types
# adjust heat fuel switches to reflect higher electrification, 0 oil, and much lower gas, approximately half of original amount
# NorthEast, in the Northeast, the move away from gas is the slowest, due to higher priced electricity
pfuel_all[,"Electricity","NE"]<-c(0.75,0.1,0.115,0,0,0.035) # switches to gas become approximately half of original
pfuel_all[,"Electricity HP","NE"]<-c(0,1,0,0,0,0) # all heat pumps stay as HP
pfuel_all[,"Gas","NE"]<-c(0.02,0.08,0.9,0,0,0) # 8% of gas becomes el HP (as opposed to 0)
pfuel_all[,"Oil","NE"]<-c(0.1,0.2,0.15,0.5,0,0.05) # much quicker scaledown of oil, 20% becomes el HP. Only 50% (as opposed to 77%) remains as oil
pfuel_all[,"Propane","NE"]<-c(0.02,0.08,0.1,0,0,0.8) # 8% of lpg becomes el HP, less remains as lpg or converts to gas
# MidWest, similar rates as West, but a little bit slower i
pfuel_all[,"Electricity","MW"]<-c(0.7,0.2,0.09,0,0,0.01) # Faster shift to el HP, smaller role for gas, about half of original
pfuel_all[,"Electricity HP","MW"]<-c(0,1,0,0,0,0) # all heat pumps stay as HP
pfuel_all[,"Gas","MW"]<-c(0.025,0.1,0.875,0,0,0) # 10% of gas becomes el HP (as opposed to 0.5%)
pfuel_all[,"Oil","MW"]<-c(0.15,0.35,0.35,0,0,0.15) # no oil is replaced with oil, large role for HP
pfuel_all[,"Propane","MW"]<-c(0.025,0.1,0.125,0,0,0.75) # 10% of lpg becomes el HP
# South,  highest rate of electrification here.
pfuel_all[,"Electricity","S"]<-c(0.75,0.25,0,0,0,0) # bigger role for el HP, no elec -> gas
pfuel_all[,"Electricity HP","S"]<-c(0,1,0,0,0,0) # all heat pumps stay as HP
pfuel_all[,"Gas","S"]<-c(0.12,0.13,0.75,0,0,0) # 13% of gas becomes el HP, 12% el Res
pfuel_all[,"Oil","S"]<-c(0.35,0.55,0.1,0,0,0) # no oil is replaced with oil, very large role for HP
pfuel_all[,"Propane","S"]<-c(0.25,0.15,0.1,0,0,0.5) # much of propane is replaced with electricity
# West, similar rates as MidWest, but a little bit faster
pfuel_all[,"Electricity","W"]<-c(0.75,0.2,0.05,0,0,0.00) # much bigger role for el HP, small switching to gas
pfuel_all[,"Electricity HP","W"]<-c(0,1,0,0,0,0) # all heat pumps stay as HP
pfuel_all[,"Gas","W"]<-c(0.1,0.1,0.8,0,0,0) # 10% of gas becomes el HP and el Res
pfuel_all[,"Oil","W"]<-c(0.25,0.5,0.25,0,0,0) # half of oil becomes el HP. none remains oil
pfuel_all[,"Propane","W"]<-c(0.25,0.25,0.25,0,0,0.25) # propane split evenly between el, el HP, gas, propane
# adjust water heat fuel switches to reflect higher electrification, lower oil, and  lower gas
# Northeast, in the Northeast, the move away from gas is the slowest, due to higher priced electricity
pwfuel_all[,"Electricity","NE"]<-c(0.95,0.05,0,0,0)
pwfuel_all[,"Gas","NE"]<-c(0.15,0.85,0,0,0) #  more gas switches to elec
pwfuel_all[,"Oil","NE"]<-c(0.3,0.15,0.5,0,0.05) # only half of oil is replaced with oil
pwfuel_all[,"Propane","NE"]<-c(0.25,0.15,0,0,0.6) # more propane becomes electric
# Midwest
pwfuel_all[,"Electricity","MW"]<-c(0.98,0.02,0,0,0)
pwfuel_all[,"Gas","MW"]<-c(0.17,0.83,0,0,0) # more gas switches to elec
pwfuel_all[,"Oil","MW"]<-c(0.65,0.35,0,0,0) #
pwfuel_all[,"Propane","MW"]<-c(0.25,0.25,0,0,0.5) # Much more propane becomes electric
# South
pwfuel_all[,"Electricity","S"]<-c(1,0,0,0,0) # all electric stays electric
pwfuel_all[,"Gas","S"]<-c(0.25,0.75,0,0,0) #  more gas switches to elec
pwfuel_all[,"Oil","S"]<-c(0.65,0.35,0,0,0) #
pwfuel_all[,"Propane","S"]<-c(0.3,0.2,0,0,0.5) # Much more propane becomes electric
# West
pwfuel_all[,"Electricity","W"]<-c(1,0,0,0,0) # all electric stays electric
pwfuel_all[,"Gas","W"]<-c(0.2,0.8,0,0,0) #   more gas switches to elec
pwfuel_all[,"Oil","W"]<-c(0.65,0.35,0,0,0) #
pwfuel_all[,"Propane","W"]<-c(0.25,0.25,0,0,0.5) # Much more propane becomes electric
pfuel_all
write.csv(pfuel_all,"../SI_Tables/pfuel_AR.csv")
## modelling of efficiency and technology upgrade scenarios to existing pre-2020 units
# Peter Berrill June 3 2021
# a more ambitious electrification focused renovation scenario
rm(list=ls()) # clear workspace i.e. remove saved variables
cat("\014") # clear console
library(dplyr)
library(ggplot2)
library(RColorBrewer)
library(readr)
library(reshape2)
setwd("~/Yale Courses/Research/Final Paper/resstock_projections/projection_scripts")
load("~/Yale Courses/Research/US Housing/AHS/RenovationStats_new.RData") # produced by script AHS_new_ren2.R
# Load in names of equipment that will be affected by renovation. produced by older version of this script. Combinations of heat fuel/efficiencies, water heat fuel/efficiencies, cooling efficiencies, insulation types
load('../../StockModelCode/rencombs.RData')
nms<-names(rs) # see which columns can be removed, none until after the RS simulations have been done
# create columns for indicating the year of the most recent renovation
rs$last_ctren_none<-rs$last_ctren_room<-rs$last_hren<-rs$last_cren<-rs$last_wren<-rs$last_iren<-0
# create columns for indicating the probability of getting renovated
rs$pi<-rs$pw<-rs$pc<-rs$ph<-rs$pctnone<-rs$pctroom<-0  # probability of renovating insulation (pi), water heater (pw), cooling equipment (pc), heating equipment (ph), changing cooling type (pctnone, pctroom)
# create columns to make note of renovations which actually make no change (e.g. because max eff level has already been reached).
# These will be turned to zero if a renovation actually involves no change
rs$change_hren<-rs$change_wren<-rs$change_iren<-rs$change_cren<-0 # note here if a renovation makes any change
rscn<-names(rs)
# define heating fuel and efficiency combos
rs$Heating.Fuel_Efficiency<-paste(rs$Heating.Fuel,rs$HVAC.Heating.Efficiency,sep = "_")
# hfeff types pre-loaded in rencombs
phfe<-matrix(0,length(hfeff_types),length(hfeff_types)) # probability of increasing heating fuel efficiency. Define the actual values later. changes to HP will need to be also reflected in the HVAC Heating Type column
colnames(phfe)<-rownames(phfe)<-hfeff_types
# define a fuel switching matrix which will apply from 2020-2024.
pfuel_2020<-pfuel_all
# adjust heat fuel switches from 2020-2024 to  reflect higher electrification and HP, and no conversion to fossil
# NorthEast
pfuel_2020[,"Electricity","NE"]<-c(0.75,0.25,0,0,0,0) # 25% of elec res switches are to HP
pfuel_2020[,"Electricity HP","NE"]<-c(0,1,0,0,0,0) # all heat pumps stay as HP
pfuel_2020[,"Gas","NE"]<-c(0,0.25,0.75,0,0,0) # 25% of gas becomes el HP
pfuel_2020[,"Oil","NE"]<-c(0,0.5,0,0.45,0,0.05) # 50% of oil becomes el HP. Only 45% remains as oil, 5% as lpg
pfuel_2020[,"Propane","NE"]<-c(0,0.25,0,0,0,0.75) # 25% of lpg becomes el HP, rest remains as lpg
pfuel_2020[,"Other/None","NE"]<-c(0.25,0.25,0,0,0.5,0) # no Other/None becomes gas. Don't this this is chosen anyway
# MidWest, similar rates as West, but a little bit slower
pfuel_2020[,"Electricity","MW"]<-c(0.65,0.35,0.09,0,0,0.01) # 35% of elec res switches are to HP
pfuel_2020[,"Electricity HP","MW"]<-c(0,1,0,0,0,0) # all heat pumps stay as HP
pfuel_2020[,"Gas","MW"]<-c(0,0.35,0.65,0,0,0) # 35% of gas becomes el HP
pfuel_2020[,"Oil","MW"]<-c(0,0.5,0.5,0,0,0) # 50% of oil becomes el HP, 50% switch to gas
pfuel_2020[,"Propane","MW"]<-c(0,0.35,0,0,0,0.65) # 35% of lpg becomes el HP
# South,  highest rate of electrification here.
pfuel_2020[,"Electricity","S"]<-c(0.5,0.5,0,0,0,0) # 50% of elec res switches are to HP
pfuel_2020[,"Electricity HP","S"]<-c(0,1,0,0,0,0) # all heat pumps stay as HP
pfuel_2020[,"Gas","S"]<-c(0,0.5,0.5,0,0,0) # 50% of gas becomes el HP
pfuel_2020[,"Oil","S"]<-c(0.15,0.8,0.05,0,0,0) # no oil is replaced with oil, 80% become HP
pfuel_2020[,"Propane","S"]<-c(0,0.5,0,0,0,0.5) # 50% of lpg becomes el HP
# West, similar rates as MidWest, but a little bit faster
pfuel_2020[,"Electricity","W"]<-c(0.6,0.40,0.09,0,0,0.01) # 40% of elec res switches are to HP
pfuel_2020[,"Electricity HP","W"]<-c(0,1,0,0,0,0) # all heat pumps stay as HP
pfuel_2020[,"Gas","W"]<-c(0,0.3,0.7,0,0,0) # 30% of gas becomes el HP
pfuel_2020[,"Oil","W"]<-c(0,0.75,0.25,0,0,0) # 75% becomes el HP. none remains oil
pfuel_2020[,"Propane","W"]<-c(0,0.75,0,0,0,0.25) # 75% of lpg becomes el HP
pfuel_2025<-pfuel_2020
# adjust heat fuel switches from 2025 onwards to  reflect higher electrification and HP, and no conversion to fossil
# All regions
pfuel_2025[,"Electricity",]<-matrix(rep(c(0.1,0.9,0,0,0,0),4),6,4) # 90% of electric renovations are to HP
pfuel_2025[,"Gas",]<-matrix(rep(c(0,1,0,0,0,0),4),6,4) # 100% of gas renovations are to HP
pfuel_2025[,"Oil",]<-matrix(rep(c(0,1,0,0,0,0),4),6,4) # 100% of oil renovations are to HP
pfuel_2025[,"Propane",]<-matrix(rep(c(0,1,0,0,0,0),4),6,4) # 100% of lpg renovations are to HP
# adjust water heat fuel switches to reflect higher electrification, lower oil, and  lower gas
# Northeast, in the Northeast, the move away from gas is the slowest, due to higher priced electricity
pwfuel_2020<-pwfuel_all
pwfuel_2020[,"Electricity",]<-matrix(rep(c(1,0,0,0,0),4),5,4) # all electric remains electric
pwfuel_2020[,"Gas",]<-matrix(rep(c(0.3,0.7,0,0,0),4),5,4) # 30% of gas becomes electric
pwfuel_2020[,"Oil",]<-matrix(rep(c(0.7,0.3,0,0,0),4),5,4) # 70% of oil becomes electric
pwfuel_2020[,"Propane",]<-matrix(rep(c(0.5,0.05,0,0,0.45),4),5,4) # 50% of propane becomes electric, 5% becomes gas
pwfuel_2025<-pwfuel_2020
# everything becomes electric
pwfuel_2025[,"Gas",]<-matrix(rep(c(1,0,0,0,0),4),5,4)
pwfuel_2025[,"Oil",]<-matrix(rep(c(1,0,0,0,0),4),5,4)
pwfuel_2025[,"Propane",]<-matrix(rep(c(1,0,0,0,0),4),5,4)
## modelling of efficiency and technology upgrade scenarios to existing pre-2020 units
# Peter Berrill Jan 18 2020
rm(list=ls()) # clear workspace i.e. remove saved variables
cat("\014") # clear console
library(dplyr)
library(ggplot2)
library(RColorBrewer)
library(readr)
library(reshape2)
setwd("~/Yale Courses/Research/Final Paper/resstock_projections/projection_scripts")
load("~/Yale Courses/Research/US Housing/AHS/RenovationStats_new.RData") # produced by script AHS_new_ren2.R
pfuel_all
round(pfuel_all,3)
# adjust the fuel switching probability matrix pfuel_all to slightly reduce chance of switching elec-> oil in NE
pfuel_all[,"Electricity","NE"]<-c(0.67,0.01,0.24,0.045,0,0.035)
round(pfuel_all,3)
write.csv(pfuel_all,"../SI_Tables/pfuel_RR.csv")
## modelling of efficiency and technology upgrade scenarios to existing pre-2020 units
# Peter Berrill June 3 2021
# a more ambitious electrification focused renovation scenario
rm(list=ls()) # clear workspace i.e. remove saved variables
cat("\014") # clear console
library(dplyr)
library(ggplot2)
library(RColorBrewer)
library(readr)
library(reshape2)
setwd("~/Yale Courses/Research/Final Paper/resstock_projections/projection_scripts")
load("~/Yale Courses/Research/US Housing/AHS/RenovationStats_new.RData") # produced by script AHS_new_ren2.R
# Load in names of equipment that will be affected by renovation. produced by older version of this script. Combinations of heat fuel/efficiencies, water heat fuel/efficiencies, cooling efficiencies, insulation types
load('../../StockModelCode/rencombs.RData')
pfuel_2020<-pfuel_all
# adjust heat fuel switches from 2020-2024 to  reflect higher electrification and HP, and no conversion to fossil
# NorthEast
pfuel_2020[,"Electricity","NE"]<-c(0.75,0.25,0,0,0,0) # 25% of elec res switches are to HP
pfuel_2020[,"Electricity HP","NE"]<-c(0,1,0,0,0,0) # all heat pumps stay as HP
pfuel_2020[,"Gas","NE"]<-c(0,0.25,0.75,0,0,0) # 25% of gas becomes el HP
pfuel_2020[,"Oil","NE"]<-c(0,0.5,0,0.45,0,0.05) # 50% of oil becomes el HP. Only 45% remains as oil, 5% as lpg
pfuel_2020[,"Propane","NE"]<-c(0,0.25,0,0,0,0.75) # 25% of lpg becomes el HP, rest remains as lpg
pfuel_2020[,"Other/None","NE"]<-c(0.25,0.25,0,0,0.5,0) # no Other/None becomes gas. Don't this this is chosen anyway
# MidWest, similar rates as West, but a little bit slower
pfuel_2020[,"Electricity","MW"]<-c(0.65,0.35,0.09,0,0,0.01) # 35% of elec res switches are to HP
pfuel_2020[,"Electricity HP","MW"]<-c(0,1,0,0,0,0) # all heat pumps stay as HP
pfuel_2020[,"Gas","MW"]<-c(0,0.35,0.65,0,0,0) # 35% of gas becomes el HP
pfuel_2020[,"Oil","MW"]<-c(0,0.5,0.5,0,0,0) # 50% of oil becomes el HP, 50% switch to gas
pfuel_2020[,"Propane","MW"]<-c(0,0.35,0,0,0,0.65) # 35% of lpg becomes el HP
# South,  highest rate of electrification here.
pfuel_2020[,"Electricity","S"]<-c(0.5,0.5,0,0,0,0) # 50% of elec res switches are to HP
pfuel_2020[,"Electricity HP","S"]<-c(0,1,0,0,0,0) # all heat pumps stay as HP
pfuel_2020[,"Gas","S"]<-c(0,0.5,0.5,0,0,0) # 50% of gas becomes el HP
pfuel_2020[,"Oil","S"]<-c(0.15,0.8,0.05,0,0,0) # no oil is replaced with oil, 80% become HP
pfuel_2020[,"Propane","S"]<-c(0,0.5,0,0,0,0.5) # 50% of lpg becomes el HP
# West, similar rates as MidWest, but a little bit faster
pfuel_2020[,"Electricity","W"]<-c(0.6,0.40,0.09,0,0,0.01) # 40% of elec res switches are to HP
pfuel_2020[,"Electricity HP","W"]<-c(0,1,0,0,0,0) # all heat pumps stay as HP
pfuel_2020[,"Gas","W"]<-c(0,0.3,0.7,0,0,0) # 30% of gas becomes el HP
pfuel_2020[,"Oil","W"]<-c(0,0.75,0.25,0,0,0) # 75% becomes el HP. none remains oil
pfuel_2020[,"Propane","W"]<-c(0,0.75,0,0,0,0.25) # 75% of lpg becomes el HP
pfuel_all
round(,3)pfuel_all
pfuel_2020
pfuel_2025
pfuel_2025<-pfuel_2020
# adjust heat fuel switches from 2025 onwards to  reflect higher electrification and HP, and no conversion to fossil
# All regions
pfuel_2025[,"Electricity",]<-matrix(rep(c(0.1,0.9,0,0,0,0),4),6,4) # 90% of electric renovations are to HP
pfuel_2025[,"Gas",]<-matrix(rep(c(0,1,0,0,0,0),4),6,4) # 100% of gas renovations are to HP
pfuel_2025[,"Oil",]<-matrix(rep(c(0,1,0,0,0,0),4),6,4) # 100% of oil renovations are to HP
pfuel_2025[,"Propane",]<-matrix(rep(c(0,1,0,0,0,0),4),6,4) # 100% of lpg renovations are to HP
pfuel_2025
write.csv(pfuel_2020,"../SI_Tables/pfuel_ER20.csv")
write.csv(pfuel_2025,"../SI_Tables/pfuel_ER25.csv")
pfuel_2020
pfuel_2025
# script to visualize results
# FINAL results plotting for final results paper. working on updated version
library(ggplot2)
library(dplyr)
library(reshape2)
library(RColorBrewer)
library(openxlsx)
# Nov 22 2020
# Updated with new results July 20 2021
rm(list=ls()) # clear workspace i.e. remove saved variables
cat("\014") # clear console
setwd("~/Yale Courses/Research/Final Paper/resstock_projections/results_scripts")
load("../Final_results/GHGall_new.RData")
View(GHGall)
View(GHGall)
64/798
110/798
95/798
90/798
View(GHGall)
View(GHGall)
11.7/17.2
64/96
62/89
80/114
78/107
## modelling of efficiency and technology upgrade scenarios to existing pre-2020 units
# Peter Berrill Jan 18 2020
rm(list=ls()) # clear workspace i.e. remove saved variables
cat("\014") # clear console
library(dplyr)
library(ggplot2)
library(RColorBrewer)
library(readr)
library(reshape2)
setwd("~/Yale Courses/Research/Final Paper/resstock_projections/projection_scripts")
load("~/Yale Courses/Research/US Housing/AHS/RenovationStats_new.RData")
# infiltration, which will also reduce with insulation retrofits
inf<-as.data.frame(read_tsv('../project_national_2025_base/housing_characteristics/Infiltration.tsv',col_names = TRUE))
inf_types<-gsub("Option=","", names(inf)[4:18])
pinf<-matrix(0,length(inf_types),length(inf_types))
colnames(pinf)<-rownames(pinf)<-inf_types
pinf[1:3,1:3]<-diag(3) # no improvement in infiltration if already ACH3 or lower
pinf[3:14,4:15]<-diag(12) # for all other initial levels, renovation reduced infiltration by one degree
View(pinf)
pwins[1:4,1]<-c(0.4,0,0.2,0.4) # it's quite difficult to insulate a brick wall, so in 40% of cases no change will be made to this wall type
pwins[3:4,2]<-c(0.25,0.75)
pwins[4:5,3]<-c(0.25,0.75)
pwins[5:6,4]<-c(0.25,0.75)
pwins[6,5:6]<-1
# wood stud walls
pwins[8:9,7]<-c(0.25,0.75)
pwins[9:10,8]<-c(0.25,0.75)
pwins[10:11,9]<-c(0.25,0.75)
pwins[11:12,10]<-c(0.25,0.75)
pwins[12,11:12]<-1
96/8
104
