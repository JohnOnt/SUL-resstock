2023-06-27 09:07:51,527 - INFO - ---------------------------------------------------------
2023-06-27 09:07:51,527 - INFO - Downsampling buildstock for  duluth  using method 1
2023-06-27 09:07:51,527 - INFO - ---------------------------------------------------------
2023-06-27 09:07:51,572 - INFO - Creating n>=1000 buildlstock by downsampling from: bst_to_search (548916 samples) 
while matching the marginal distribution of 13 key HCs from: bst_to_match (184 samples), 
['Income', 'ASHRAE IECC Climate Zone 2004', 'State', 'Geometry Building Type RECS', 'Heating Fuel', 'HVAC Cooling Type', 'Tenure', 'Water Heater Fuel', 'Vintage ACS', 'Geometry Floor Area Bin', 'HVAC Heating Type', 'Federal Poverty Level', 'Vacancy Status']
2023-06-27 09:07:51,573 - INFO - 
2023-06-27 09:07:51,573 - INFO - 
---- Attempt 1: downsample using 13 key HCs: ----
2023-06-27 09:07:51,707 - INFO -    Located 1918 positively weighted rows in bst_to_search
2023-06-27 09:07:51,707 - INFO - 
 -> Step 2 : Weight Recalculation
Method 1A - normalizing to exact joint-prob from bst_to_match ...
2023-06-27 09:07:51,726 - INFO -    Downsampling FAILED with insufficient rows: Recalculation leads to 214 positively weighted samples 
retry by relaxing HC_to_search by removing: build_existing_model.vacancy_status...
2023-06-27 09:07:51,726 - INFO - 
---- Attempt 2: downsample using 12 key HCs: ----
2023-06-27 09:07:51,729 - INFO -    Located 1918 positively weighted rows in bst_to_search
2023-06-27 09:07:51,729 - INFO - 
 -> Step 2 : Weight Recalculation
Method 1A - normalizing to exact joint-prob from bst_to_match ...
2023-06-27 09:07:51,759 - INFO -    Downsampling FAILED with insufficient rows: Recalculation leads to 226 positively weighted samples 
retry by relaxing HC_to_search by removing: build_existing_model.federal_poverty_level...
2023-06-27 09:07:51,759 - INFO - 
---- Attempt 3: downsample using 11 key HCs: ----
2023-06-27 09:07:51,762 - INFO -    Located 1918 positively weighted rows in bst_to_search
2023-06-27 09:07:51,763 - INFO - 
 -> Step 2 : Weight Recalculation
Method 1A - normalizing to exact joint-prob from bst_to_match ...
2023-06-27 09:07:51,779 - INFO -    Downsampling FAILED with insufficient rows: Recalculation leads to 253 positively weighted samples 
retry by relaxing HC_to_search by removing: build_existing_model.hvac_heating_type...
2023-06-27 09:07:51,779 - INFO - 
---- Attempt 4: downsample using 10 key HCs: ----
2023-06-27 09:07:51,783 - INFO -    Located 1918 positively weighted rows in bst_to_search
2023-06-27 09:07:51,783 - INFO - 
 -> Step 2 : Weight Recalculation
Method 1A - normalizing to exact joint-prob from bst_to_match ...
2023-06-27 09:07:51,803 - INFO -    Downsampling FAILED with insufficient rows: Recalculation leads to 274 positively weighted samples 
retry by relaxing HC_to_search by removing: build_existing_model.geometry_floor_area_bin...
2023-06-27 09:07:51,804 - INFO - 
---- Attempt 5: downsample using 9 key HCs: ----
2023-06-27 09:07:51,807 - INFO -    Located 1918 positively weighted rows in bst_to_search
2023-06-27 09:07:51,807 - INFO - 
 -> Step 2 : Weight Recalculation
Method 1A - normalizing to exact joint-prob from bst_to_match ...
2023-06-27 09:07:51,821 - INFO -    Downsampling FAILED with insufficient rows: Recalculation leads to 356 positively weighted samples 
retry by relaxing HC_to_search by removing: build_existing_model.vintage_acs...
2023-06-27 09:07:51,821 - INFO - 
---- Attempt 6: downsample using 8 key HCs: ----
2023-06-27 09:07:51,824 - INFO -    Located 1918 positively weighted rows in bst_to_search
2023-06-27 09:07:51,824 - INFO - 
 -> Step 2 : Weight Recalculation
Method 1A - normalizing to exact joint-prob from bst_to_match ...
2023-06-27 09:07:51,843 - INFO -    Downsampling FAILED with insufficient rows: Recalculation leads to 643 positively weighted samples 
retry by relaxing HC_to_search by removing: build_existing_model.water_heater_fuel...
2023-06-27 09:07:51,843 - INFO - 
---- Attempt 7: downsample using 7 key HCs: ----
2023-06-27 09:07:51,846 - INFO -    Located 1918 positively weighted rows in bst_to_search
2023-06-27 09:07:51,847 - INFO - 
 -> Step 2 : Weight Recalculation
Method 1A - normalizing to exact joint-prob from bst_to_match ...
2023-06-27 09:07:51,861 - INFO -    Downsampling FAILED with insufficient rows: Recalculation leads to 782 positively weighted samples 
retry by relaxing HC_to_search by removing: build_existing_model.tenure...
2023-06-27 09:07:51,861 - INFO - 
---- Attempt 8: downsample using 6 key HCs: ----
2023-06-27 09:07:51,863 - INFO -    Located 1918 positively weighted rows in bst_to_search
2023-06-27 09:07:51,863 - INFO - 
 -> Step 2 : Weight Recalculation
Method 1A - normalizing to exact joint-prob from bst_to_match ...
2023-06-27 09:07:51,874 - INFO -    Downsampling FAILED with insufficient rows: Recalculation leads to 828 positively weighted samples 
retry by relaxing HC_to_search by removing: build_existing_model.hvac_cooling_type...
2023-06-27 09:07:51,875 - INFO - 
---- Attempt 9: downsample using 5 key HCs: ----
2023-06-27 09:07:51,876 - INFO -    Located 1918 positively weighted rows in bst_to_search
2023-06-27 09:07:51,876 - INFO - 
 -> Step 2 : Weight Recalculation
Method 1A - normalizing to exact joint-prob from bst_to_match ...
2023-06-27 09:07:51,887 - INFO - 

** Downsampled to: 1217 samples, by matching to: ['build_existing_model.income', 'build_existing_model.ashrae_iecc_climate_zone_2004', 'build_existing_model.state', 'build_existing_model.geometry_building_type_recs', 'build_existing_model.heating_fuel']
2023-06-27 09:07:51,901 - INFO - 
 -> Step 3 : Weight Normalization
2023-06-27 09:07:51,903 - INFO - Checking marginals from weight_map of n=1217...
2023-06-27 09:07:51,907 - INFO -  [[ build_existing_model.income ]] 
2023-06-27 09:07:51,912 - INFO - 
                matched     truth  pct_diff
10000-14999    0.048913  0.048913       0.0
100000-119999  0.054348  0.054348       0.0
120000-139999  0.048913  0.048913      -0.0
140000-159999  0.027174  0.027174       0.0
15000-19999    0.048913  0.048913       0.0
160000-179999  0.016304  0.016304       0.0
180000-199999  0.010870  0.010870       0.0
20000-24999    0.076087  0.076087       0.0
200000+        0.059783  0.059783      -0.0
25000-29999    0.048913  0.048913      -0.0
30000-34999    0.038043  0.038043      -0.0
35000-39999    0.043478  0.043478       0.0
40000-44999    0.048913  0.048913       0.0
45000-49999    0.032609  0.032609       0.0
50000-59999    0.070652  0.070652       0.0
60000-69999    0.086957  0.086957       0.0
70000-79999    0.043478  0.043478       0.0
80000-99999    0.125000  0.125000       0.0
<10000         0.070652  0.070652       0.0

2023-06-27 09:07:51,915 - INFO -  [[ build_existing_model.ashrae_iecc_climate_zone_2004 ]] 
2023-06-27 09:07:51,919 - INFO - 
    matched  truth  pct_diff
7A      1.0    1.0       0.0

2023-06-27 09:07:51,922 - INFO -  [[ build_existing_model.state ]] 
2023-06-27 09:07:51,926 - INFO - 
    matched  truth  pct_diff
MN      1.0    1.0       0.0

2023-06-27 09:07:51,929 - INFO -  [[ build_existing_model.geometry_building_type_recs ]] 
2023-06-27 09:07:51,935 - INFO - 
                                matched     truth  pct_diff
Mobile Home                    0.032609  0.032609       0.0
Multi-Family with 2 - 4 Units  0.125000  0.125000       0.0
Multi-Family with 5+ Units     0.184783  0.184783       0.0
Single-Family Attached         0.027174  0.027174       0.0
Single-Family Detached         0.630435  0.630435       0.0

2023-06-27 09:07:51,939 - INFO -  [[ build_existing_model.heating_fuel ]] 
2023-06-27 09:07:51,943 - INFO - 
              matched     truth  pct_diff
Electricity  0.190217  0.190217      -0.0
Fuel Oil     0.054348  0.054348       0.0
Natural Gas  0.695652  0.695652       0.0
None         0.010870  0.010870       0.0
Other Fuel   0.010870  0.010870       0.0
Propane      0.038043  0.038043      -0.0

2023-06-27 09:07:51,943 - INFO - For unmatched HC:
2023-06-27 09:07:51,943 - INFO - Checking marginals from weight_map of n=1217...
2023-06-27 09:07:51,947 - INFO -  [[ build_existing_model.hvac_cooling_type ]] 
2023-06-27 09:07:51,951 - INFO - 
             matched     truth   pct_diff
Central AC  0.233426  0.228261   2.262730
Heat Pump   0.023367  0.016304  43.320617
None        0.465966  0.456522   2.068816
Room AC     0.277240  0.298913  -7.250492

2023-06-27 09:07:51,954 - INFO -  [[ build_existing_model.tenure ]] 
2023-06-27 09:07:51,958 - INFO - 
         matched  truth  pct_diff
Owner   0.643933  0.625  3.029217
Renter  0.356067  0.375 -5.048696

2023-06-27 09:07:51,962 - INFO -  [[ build_existing_model.water_heater_fuel ]] 
2023-06-27 09:07:51,965 - INFO - 
              matched     truth   pct_diff
Electricity  0.305797  0.309783  -1.286571
Natural Gas  0.664103  0.663043   0.159733
Propane      0.030100  0.027174  10.769410

2023-06-27 09:07:51,969 - INFO -  [[ build_existing_model.vintage_acs ]] 
2023-06-27 09:07:51,972 - INFO - 
          matched     truth    pct_diff
1940-59  0.162034  0.201087  -19.420811
1960-79  0.234997  0.163043   44.131261
1980-99  0.203856  0.125000   63.084402
2000-09  0.118934  0.092391   28.728220
2010s    0.038565  0.010870  254.795989
<1940    0.241615  0.407609  -40.723744

2023-06-27 09:07:51,976 - INFO -  [[ build_existing_model.geometry_floor_area_bin ]] 
2023-06-27 09:07:51,980 - INFO - 
            matched     truth   pct_diff
0-1499     0.524430  0.548913  -4.460215
1500-2499  0.309200  0.304348   1.594375
2500-3999  0.142508  0.119565  19.188758
4000+      0.023861  0.027174 -12.191202

2023-06-27 09:07:51,984 - INFO -  [[ build_existing_model.hvac_heating_type ]] 
2023-06-27 09:07:51,989 - INFO - 
                     matched     truth   pct_diff
Ducted Heat Pump    0.023367  0.016304  43.320617
Ducted Heating      0.586201  0.586957  -0.128671
Non-Ducted Heating  0.379562  0.385870  -1.634724
None                0.010870  0.010870   0.000000

2023-06-27 09:07:51,994 - INFO -  [[ build_existing_model.federal_poverty_level ]] 
2023-06-27 09:07:51,999 - INFO - 
           matched     truth   pct_diff
0-100%    0.121060  0.125000  -3.152208
100-150%  0.093659  0.081522  14.888765
150-200%  0.101558  0.125000 -18.753853
200-300%  0.152364  0.130435  16.812493
300-400%  0.153444  0.168478  -8.923279
400%+     0.377915  0.369565   2.259261

2023-06-27 09:07:52,004 - INFO -  [[ build_existing_model.vacancy_status ]] 
2023-06-27 09:07:52,008 - INFO - 
           matched     truth    pct_diff
Occupied  0.809977  0.940217  -13.852172
Vacant    0.190023  0.059783  217.856889

2023-06-27 09:07:52,015 - INFO - truth vs. matched - per dwelling unit energy:
2023-06-27 09:07:52,019 - INFO - 
                                     matched       truth   pct_diff
energy_use_total_m_btu            147.793793  163.476266  -9.593119
fuel_use_electricity_total_m_btu   31.157455   34.645766 -10.068505
fuel_use_fuel_oil_total_m_btu      10.093723   11.664054 -13.462994
fuel_use_natural_gas_total_m_btu   99.981415  110.006929  -9.113530
fuel_use_propane_total_m_btu        6.561208    7.159533  -8.357038

2023-06-27 09:07:52,033 - INFO - truth vs. matched - per dwelling unit energy:
2023-06-27 09:07:52,041 - INFO - 
                                                                         matched       truth   pct_diff
build_existing_model.vacancy_status                                                                    
Occupied                            energy_use_total_m_btu            159.997303  167.282254  -4.354886
                                    fuel_use_electricity_total_m_btu   35.455829   35.986312  -1.474126
                                    fuel_use_fuel_oil_total_m_btu      10.303763   12.405699 -16.943316
                                    fuel_use_natural_gas_total_m_btu  107.569067  111.275491  -3.330854
                                    fuel_use_propane_total_m_btu        6.668662    7.614763 -12.424568
Vacant                              energy_use_total_m_btu             95.776123  103.618455  -7.568470
                                    fuel_use_electricity_total_m_btu   12.835567   13.562636  -5.360824
                                    fuel_use_fuel_oil_total_m_btu       9.198428    0.000000        inf
                                    fuel_use_natural_gas_total_m_btu   67.638916   90.055909 -24.892306
                                    fuel_use_propane_total_m_btu        6.103184    0.000000        inf

2023-06-27 09:07:52,057 - INFO - truth vs. matched - per dwelling unit energy:
2023-06-27 09:07:52,061 - INFO - 
                                                                 matched       truth   pct_diff
build_existing_model.tenure                                                                    
Owner                       energy_use_total_m_btu            182.861069  204.956009 -10.780333
                            fuel_use_electricity_total_m_btu   32.490282   34.461339  -5.719618
                            fuel_use_fuel_oil_total_m_btu      14.637701   16.189783  -9.586795
                            fuel_use_natural_gas_total_m_btu  126.287505  143.764409 -12.156628
                            fuel_use_propane_total_m_btu        9.445582   10.540496 -10.387686
Renter                      energy_use_total_m_btu             84.376127   94.343362 -10.564850
                            fuel_use_electricity_total_m_btu   28.747095   34.953145 -17.755340
                            fuel_use_fuel_oil_total_m_btu       1.876134    4.121174 -54.475740
                            fuel_use_natural_gas_total_m_btu   52.407979   53.744464  -2.486740
                            fuel_use_propane_total_m_btu        1.344940    1.524594 -11.783715

2023-06-27 09:07:52,072 - INFO - truth vs. matched - per dwelling unit energy:
2023-06-27 09:07:52,077 - INFO - 
                                                                                matched       truth    pct_diff
build_existing_model.federal_poverty_level                                                                     
0-100%                                     energy_use_total_m_btu             97.886278  101.524304   -3.583405
                                           fuel_use_electricity_total_m_btu   24.097992   27.223652  -11.481415
                                           fuel_use_fuel_oil_total_m_btu       4.002044    0.000000         inf
                                           fuel_use_natural_gas_total_m_btu   69.701232   74.300783   -6.190447
                                           fuel_use_propane_total_m_btu        0.084987    0.000000         inf
100-150%                                   energy_use_total_m_btu            114.646397  136.600800  -16.071943
                                           fuel_use_electricity_total_m_btu   26.684752   26.570400    0.430373
                                           fuel_use_fuel_oil_total_m_btu      10.534272   25.500933  -58.690643
                                           fuel_use_natural_gas_total_m_btu   74.106612   84.529400  -12.330370
                                           fuel_use_propane_total_m_btu        3.320878    0.000000         inf
150-200%                                   energy_use_total_m_btu            126.981618  141.457652  -10.233476
                                           fuel_use_electricity_total_m_btu   32.319800   36.226609  -10.784363
                                           fuel_use_fuel_oil_total_m_btu      10.098820   21.982435  -54.059593
                                           fuel_use_natural_gas_total_m_btu   83.159316   74.217739   12.047763
                                           fuel_use_propane_total_m_btu        1.403683    9.030826  -84.456765
200-300%                                   energy_use_total_m_btu            138.663178  140.211375   -1.104188
                                           fuel_use_electricity_total_m_btu   35.692709   37.443417   -4.675610
                                           fuel_use_fuel_oil_total_m_btu       8.250508    4.007042  105.900218
                                           fuel_use_natural_gas_total_m_btu   88.178497   91.173833   -3.285303
                                           fuel_use_propane_total_m_btu        6.541413    7.587083  -13.782241
300-400%                                   energy_use_total_m_btu            151.870936  178.039000  -14.697939
                                           fuel_use_electricity_total_m_btu   31.067306   37.513323  -17.183272
                                           fuel_use_fuel_oil_total_m_btu       3.975813    0.000000         inf
                                           fuel_use_natural_gas_total_m_btu  108.245344  132.443065  -18.270282
                                           fuel_use_propane_total_m_btu        8.582416    8.082484    6.185377
400%+                                      energy_use_total_m_btu            179.614608  199.378735   -9.912856
                                           fuel_use_electricity_total_m_btu   32.423099   36.108147  -10.205586
                                           fuel_use_fuel_oil_total_m_btu      15.161740   17.086868  -11.266711
                                           fuel_use_natural_gas_total_m_btu  122.017679  136.227956  -10.431248
                                           fuel_use_propane_total_m_btu       10.012134    9.955853    0.565308

2023-06-27 09:07:52,081 - INFO - >> Database down-selected to 1217 buildings, based on input data of 184 buildings, result outputs to: 
/Users/lliu2/Documents/GitHub/ResStock/euss_cleap/data_/downsampled_buildings_id/euss1_2018_results_up00__downsampled_method1__duluth.csv

