2023-06-21 01:53:32,215 - INFO - ---------------------------------------------------------
2023-06-21 01:53:32,218 - INFO - Downsampling buildstock for  north_birmingham  using method 1
2023-06-21 01:53:32,219 - INFO - ---------------------------------------------------------
2023-06-21 01:53:32,323 - INFO - Creating n>=1000 buildlstock by downsampling from: bst_to_search (548916 samples) 
while matching the marginal distribution of 13 key HCs from: bst_to_match (470 samples), 
['Income', 'ASHRAE IECC Climate Zone 2004', 'State', 'Geometry Building Type RECS', 'Heating Fuel', 'HVAC Cooling Type', 'Tenure', 'Water Heater Fuel', 'Vintage ACS', 'Geometry Floor Area Bin', 'HVAC Heating Type', 'Federal Poverty Level', 'Vacancy Status']
2023-06-21 01:53:32,325 - INFO - 
2023-06-21 01:53:32,325 - INFO - 
---- Attempt 1: downsample using 13 key HCs: ----
2023-06-21 01:53:32,487 - INFO -    Located 7881 positively weighted rows in bst_to_search
2023-06-21 01:53:32,488 - INFO - 
 -> Step 2 : Weight Recalculation
Method 1A - normalizing to exact joint-prob from bst_to_match ...
2023-06-21 01:53:32,554 - INFO -    Downsampling FAILED with insufficient rows: Recalculation leads to 970 positively weighted samples 
retry by relaxing HC_to_search by removing: build_existing_model.vacancy_status...
2023-06-21 01:53:32,555 - INFO - 
---- Attempt 2: downsample using 12 key HCs: ----
2023-06-21 01:53:32,564 - INFO -    Located 7881 positively weighted rows in bst_to_search
2023-06-21 01:53:32,565 - INFO - 
 -> Step 2 : Weight Recalculation
Method 1A - normalizing to exact joint-prob from bst_to_match ...
2023-06-21 01:53:32,606 - INFO - 

** Downsampled to: 1124 samples, by matching to: ['build_existing_model.income', 'build_existing_model.ashrae_iecc_climate_zone_2004', 'build_existing_model.state', 'build_existing_model.geometry_building_type_recs', 'build_existing_model.heating_fuel', 'build_existing_model.hvac_cooling_type', 'build_existing_model.tenure', 'build_existing_model.water_heater_fuel', 'build_existing_model.vintage_acs', 'build_existing_model.geometry_floor_area_bin', 'build_existing_model.hvac_heating_type', 'build_existing_model.federal_poverty_level']
2023-06-21 01:53:32,626 - INFO - 
 -> Step 3 : Weight Normalization
2023-06-21 01:53:32,628 - INFO - Checking marginals from weight_map of n=1124...
2023-06-21 01:53:32,640 - INFO -  [[ build_existing_model.income ]] 
2023-06-21 01:53:32,649 - INFO - 
                matched     truth  pct_diff
10000-14999    0.089362  0.089362       0.0
100000-119999  0.040426  0.040426       0.0
120000-139999  0.036170  0.036170       0.0
140000-159999  0.014894  0.014894       0.0
15000-19999    0.078723  0.078723      -0.0
160000-179999  0.002128  0.002128       0.0
180000-199999  0.008511  0.008511       0.0
20000-24999    0.065957  0.065957       0.0
200000+        0.040426  0.040426      -0.0
25000-29999    0.059574  0.059574       0.0
30000-34999    0.051064  0.051064       0.0
35000-39999    0.031915  0.031915       0.0
40000-44999    0.051064  0.051064       0.0
45000-49999    0.038298  0.038298       0.0
50000-59999    0.072340  0.072340       0.0
60000-69999    0.055319  0.055319       0.0
70000-79999    0.042553  0.042553       0.0
80000-99999    0.070213  0.070213       0.0
<10000         0.151064  0.151064       0.0

2023-06-21 01:53:32,656 - INFO -  [[ build_existing_model.ashrae_iecc_climate_zone_2004 ]] 
2023-06-21 01:53:32,662 - INFO - 
    matched  truth  pct_diff
3A      1.0    1.0       0.0

2023-06-21 01:53:32,667 - INFO -  [[ build_existing_model.state ]] 
2023-06-21 01:53:32,672 - INFO - 
    matched  truth  pct_diff
AL      1.0    1.0       0.0

2023-06-21 01:53:32,677 - INFO -  [[ build_existing_model.geometry_building_type_recs ]] 
2023-06-21 01:53:32,682 - INFO - 
                                matched     truth  pct_diff
Mobile Home                    0.014894  0.014894       0.0
Multi-Family with 2 - 4 Units  0.068085  0.068085       0.0
Multi-Family with 5+ Units     0.246809  0.246809       0.0
Single-Family Attached         0.014894  0.014894       0.0
Single-Family Detached         0.655319  0.655319       0.0

2023-06-21 01:53:32,687 - INFO -  [[ build_existing_model.heating_fuel ]] 
2023-06-21 01:53:32,691 - INFO - 
              matched     truth  pct_diff
Electricity  0.487234  0.487234      -0.0
Natural Gas  0.502128  0.502128       0.0
Other Fuel   0.002128  0.002128       0.0
Propane      0.008511  0.008511       0.0

2023-06-21 01:53:32,696 - INFO -  [[ build_existing_model.hvac_cooling_type ]] 
2023-06-21 01:53:32,701 - INFO - 
             matched     truth  pct_diff
Central AC  0.653191  0.653191       0.0
Heat Pump   0.121277  0.121277       0.0
None        0.036170  0.036170       0.0
Room AC     0.189362  0.189362       0.0

2023-06-21 01:53:32,706 - INFO -  [[ build_existing_model.tenure ]] 
2023-06-21 01:53:32,710 - INFO - 
         matched     truth  pct_diff
Owner   0.523404  0.523404       0.0
Renter  0.476596  0.476596       0.0

2023-06-21 01:53:32,717 - INFO -  [[ build_existing_model.water_heater_fuel ]] 
2023-06-21 01:53:32,722 - INFO - 
              matched     truth  pct_diff
Electricity  0.542553  0.542553       0.0
Natural Gas  0.455319  0.455319       0.0
Propane      0.002128  0.002128       0.0

2023-06-21 01:53:32,727 - INFO -  [[ build_existing_model.vintage_acs ]] 
2023-06-21 01:53:32,732 - INFO - 
          matched     truth  pct_diff
1940-59  0.304255  0.304255       0.0
1960-79  0.289362  0.289362       0.0
1980-99  0.146809  0.146809       0.0
2000-09  0.072340  0.072340       0.0
2010s    0.031915  0.031915       0.0
<1940    0.155319  0.155319       0.0

2023-06-21 01:53:32,738 - INFO -  [[ build_existing_model.geometry_floor_area_bin ]] 
2023-06-21 01:53:32,743 - INFO - 
            matched     truth  pct_diff
0-1499     0.621277  0.621277       0.0
1500-2499  0.289362  0.289362       0.0
2500-3999  0.076596  0.076596      -0.0
4000+      0.012766  0.012766       0.0

2023-06-21 01:53:32,748 - INFO -  [[ build_existing_model.hvac_heating_type ]] 
2023-06-21 01:53:32,753 - INFO - 
                     matched     truth  pct_diff
Ducted Heat Pump    0.121277  0.121277       0.0
Ducted Heating      0.670213  0.670213       0.0
Non-Ducted Heating  0.208511  0.208511       0.0

2023-06-21 01:53:32,760 - INFO -  [[ build_existing_model.federal_poverty_level ]] 
2023-06-21 01:53:32,767 - INFO - 
           matched     truth  pct_diff
0-100%    0.234043  0.234043       0.0
100-150%  0.142553  0.142553       0.0
150-200%  0.093617  0.093617       0.0
200-300%  0.148936  0.148936       0.0
300-400%  0.110638  0.110638       0.0
400%+     0.270213  0.270213       0.0

2023-06-21 01:53:32,769 - INFO - For unmatched HC:
2023-06-21 01:53:32,769 - INFO - Checking marginals from weight_map of n=1124...
2023-06-21 01:53:32,775 - INFO -  [[ build_existing_model.vacancy_status ]] 
2023-06-21 01:53:32,779 - INFO - 
           matched     truth  pct_diff
Occupied  0.815184  0.812766  0.297481
Vacant    0.184816  0.187234 -1.291336

2023-06-21 01:53:32,788 - INFO - truth vs. matched - per dwelling unit energy:
2023-06-21 01:53:32,794 - INFO - 
                                                      matched  ...  pct_diff
report_simulation_output.energy_use_total_m_btu     71.618456  ...  0.312409
report_simulation_output.fuel_use_electricity_t...  44.801582  ... -0.049672
report_simulation_output.fuel_use_fuel_oil_tota...   0.000000  ...       NaN
report_simulation_output.fuel_use_natural_gas_t...  26.367221  ...  0.914415
report_simulation_output.fuel_use_propane_total...   0.449676  ...  1.439857

[5 rows x 3 columns]

2023-06-21 01:53:32,808 - INFO - truth vs. matched - per dwelling unit energy:
2023-06-21 01:53:32,819 - INFO - 
                                                                                          matched  ...   pct_diff
build_existing_model.vacancy_status                                                                ...           
Occupied                            report_simulation_output.energy_use_total_m_btu     81.266382  ...   0.439303
                                    report_simulation_output.fuel_use_electricity_t...  50.180931  ...  -0.234942
                                    report_simulation_output.fuel_use_fuel_oil_tota...   0.000000  ...        NaN
                                    report_simulation_output.fuel_use_natural_gas_t...  30.533840  ...   1.554549
                                    report_simulation_output.fuel_use_propane_total...   0.551626  ...   1.138989
Vacant                              report_simulation_output.energy_use_total_m_btu     29.063576  ...  -3.409174
                                    report_simulation_output.fuel_use_electricity_t...  21.074456  ...   0.086462
                                    report_simulation_output.fuel_use_fuel_oil_tota...   0.000000  ...        NaN
                                    report_simulation_output.fuel_use_natural_gas_t...   7.989180  ... -11.557405
                                    report_simulation_output.fuel_use_propane_total...   0.000000  ...        NaN

[10 rows x 3 columns]

2023-06-21 01:53:32,830 - INFO - truth vs. matched - per dwelling unit energy:
2023-06-21 01:53:32,837 - INFO - 
                                                                                  matched  ...   pct_diff
build_existing_model.tenure                                                                ...           
Owner                       report_simulation_output.energy_use_total_m_btu     88.614461  ...   0.885851
                            report_simulation_output.fuel_use_electricity_t...  52.096643  ...   0.612543
                            report_simulation_output.fuel_use_fuel_oil_tota...   0.000000  ...        NaN
                            report_simulation_output.fuel_use_natural_gas_t...  35.801644  ...   1.320931
                            report_simulation_output.fuel_use_propane_total...   0.716190  ...  -0.808008
Renter                      report_simulation_output.energy_use_total_m_btu     52.953202  ...  -0.724641
                            report_simulation_output.fuel_use_electricity_t...  36.790042  ...  -1.062357
                            report_simulation_output.fuel_use_fuel_oil_tota...   0.000000  ...        NaN
                            report_simulation_output.fuel_use_natural_gas_t...  16.006203  ...  -0.070445
                            report_simulation_output.fuel_use_propane_total...   0.156987  ...  14.432417

[10 rows x 3 columns]

2023-06-21 01:53:32,848 - INFO - truth vs. matched - per dwelling unit energy:
2023-06-21 01:53:32,857 - INFO - 
                                                                                                 matched  ...   pct_diff
build_existing_model.federal_poverty_level                                                                ...           
0-100%                                     report_simulation_output.energy_use_total_m_btu     55.080961  ...  -3.639112
                                           report_simulation_output.fuel_use_electricity_t...  36.935148  ...  -1.448504
                                           report_simulation_output.fuel_use_fuel_oil_tota...   0.000000  ...        NaN
                                           report_simulation_output.fuel_use_natural_gas_t...  17.740513  ...  -8.066995
                                           report_simulation_output.fuel_use_propane_total...   0.405321  ...   5.032730
100-150%                                   report_simulation_output.energy_use_total_m_btu     71.901074  ...   1.315250
                                           report_simulation_output.fuel_use_electricity_t...  42.048233  ...  -1.810908
                                           report_simulation_output.fuel_use_fuel_oil_tota...   0.000000  ...        NaN
                                           report_simulation_output.fuel_use_natural_gas_t...  27.961037  ...   6.448027
                                           report_simulation_output.fuel_use_propane_total...   1.891854  ...   0.807417
150-200%                                   report_simulation_output.energy_use_total_m_btu     62.042485  ...   1.703346
                                           report_simulation_output.fuel_use_electricity_t...  43.186303  ...  -0.741990
                                           report_simulation_output.fuel_use_fuel_oil_tota...   0.000000  ...        NaN
                                           report_simulation_output.fuel_use_natural_gas_t...  18.750733  ...   7.831707
                                           report_simulation_output.fuel_use_propane_total...   0.105432  ...   0.000000
200-300%                                   report_simulation_output.energy_use_total_m_btu     70.061819  ...  -0.000972
                                           report_simulation_output.fuel_use_electricity_t...  41.633805  ...  -0.473346
                                           report_simulation_output.fuel_use_fuel_oil_tota...   0.000000  ...        NaN
                                           report_simulation_output.fuel_use_natural_gas_t...  28.392170  ...   0.784790
                                           report_simulation_output.fuel_use_propane_total...   0.035883  ... -39.836327
300-400%                                   report_simulation_output.energy_use_total_m_btu     75.331421  ...   4.163690
                                           report_simulation_output.fuel_use_electricity_t...  45.871975  ...   5.213969
                                           report_simulation_output.fuel_use_fuel_oil_tota...   0.000000  ...        NaN
                                           report_simulation_output.fuel_use_natural_gas_t...  29.451810  ...   2.542935
                                           report_simulation_output.fuel_use_propane_total...   0.007599  ...        inf
400%+                                      report_simulation_output.energy_use_total_m_btu     88.448553  ...   0.616764
                                           report_simulation_output.fuel_use_electricity_t...  54.934955  ...   0.158884
                                           report_simulation_output.fuel_use_fuel_oil_tota...   0.000000  ...        NaN
                                           report_simulation_output.fuel_use_natural_gas_t...  33.258030  ...   1.360056
                                           report_simulation_output.fuel_use_propane_total...   0.255609  ...   3.561323

[30 rows x 3 columns]

2023-06-21 01:53:32,878 - INFO - >> Database down-selected to 1124 buildings, based on input data of 470 buildings, result outputs to: 
/Users/lliu2/Documents/GitHub/ResStock/euss_cleap/data_/downsampled_buildings_id/euss1_2018_results_up00__downsampled_method1__north_birmingham.csv

