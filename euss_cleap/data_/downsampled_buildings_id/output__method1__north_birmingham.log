2023-06-21 15:16:45,335 - INFO - ---------------------------------------------------------
2023-06-21 15:16:45,344 - INFO - Downsampling buildstock for  north_birmingham  using method 1
2023-06-21 15:16:45,345 - INFO - ---------------------------------------------------------
2023-06-21 15:16:45,471 - INFO - Creating n>=1000 buildlstock by downsampling from: bst_to_search (548916 samples) 
while matching the marginal distribution of 13 key HCs from: bst_to_match (470 samples), 
['Income', 'ASHRAE IECC Climate Zone 2004', 'State', 'Geometry Building Type RECS', 'Heating Fuel', 'HVAC Cooling Type', 'Tenure', 'Water Heater Fuel', 'Vintage ACS', 'Geometry Floor Area Bin', 'HVAC Heating Type', 'Federal Poverty Level', 'Vacancy Status']
2023-06-21 15:16:45,472 - INFO - 
2023-06-21 15:16:45,473 - INFO - 
---- Attempt 1: downsample using 13 key HCs: ----
2023-06-21 15:16:45,670 - INFO -    Located 7881 positively weighted rows in bst_to_search
2023-06-21 15:16:45,670 - INFO - 
 -> Step 2 : Weight Recalculation
Method 1A - normalizing to exact joint-prob from bst_to_match ...
2023-06-21 15:16:45,719 - INFO -    Downsampling FAILED with insufficient rows: Recalculation leads to 970 positively weighted samples 
retry by relaxing HC_to_search by removing: build_existing_model.vacancy_status...
2023-06-21 15:16:45,720 - INFO - 
---- Attempt 2: downsample using 12 key HCs: ----
2023-06-21 15:16:45,727 - INFO -    Located 7881 positively weighted rows in bst_to_search
2023-06-21 15:16:45,727 - INFO - 
 -> Step 2 : Weight Recalculation
Method 1A - normalizing to exact joint-prob from bst_to_match ...
2023-06-21 15:16:45,764 - INFO - 

** Downsampled to: 1124 samples, by matching to: ['build_existing_model.income', 'build_existing_model.ashrae_iecc_climate_zone_2004', 'build_existing_model.state', 'build_existing_model.geometry_building_type_recs', 'build_existing_model.heating_fuel', 'build_existing_model.hvac_cooling_type', 'build_existing_model.tenure', 'build_existing_model.water_heater_fuel', 'build_existing_model.vintage_acs', 'build_existing_model.geometry_floor_area_bin', 'build_existing_model.hvac_heating_type', 'build_existing_model.federal_poverty_level']
2023-06-21 15:16:45,797 - INFO - 
 -> Step 3 : Weight Normalization
2023-06-21 15:16:45,799 - INFO - Checking marginals from weight_map of n=1124...
2023-06-21 15:16:45,804 - INFO -  [[ build_existing_model.income ]] 
2023-06-21 15:16:45,808 - INFO - 
                matched     truth  pct_diff
10000-14999    0.089362  0.089362       0.0
100000-119999  0.040426  0.040426       0.0
120000-139999  0.036170  0.036170       0.0
140000-159999  0.014894  0.014894       0.0
15000-19999    0.078723  0.078723      -0.0
160000-179999  0.002128  0.002128       0.0
180000-199999  0.008511  0.008511       0.0
20000-24999    0.065957  0.065957       0.0
200000+        0.040426  0.040426      -0.0
25000-29999    0.059574  0.059574       0.0
30000-34999    0.051064  0.051064       0.0
35000-39999    0.031915  0.031915       0.0
40000-44999    0.051064  0.051064       0.0
45000-49999    0.038298  0.038298       0.0
50000-59999    0.072340  0.072340       0.0
60000-69999    0.055319  0.055319       0.0
70000-79999    0.042553  0.042553       0.0
80000-99999    0.070213  0.070213       0.0
<10000         0.151064  0.151064       0.0

2023-06-21 15:16:45,812 - INFO -  [[ build_existing_model.ashrae_iecc_climate_zone_2004 ]] 
2023-06-21 15:16:45,817 - INFO - 
    matched  truth  pct_diff
3A      1.0    1.0       0.0

2023-06-21 15:16:45,821 - INFO -  [[ build_existing_model.state ]] 
2023-06-21 15:16:45,824 - INFO - 
    matched  truth  pct_diff
AL      1.0    1.0       0.0

2023-06-21 15:16:45,828 - INFO -  [[ build_existing_model.geometry_building_type_recs ]] 
2023-06-21 15:16:45,832 - INFO - 
                                matched     truth  pct_diff
Mobile Home                    0.014894  0.014894       0.0
Multi-Family with 2 - 4 Units  0.068085  0.068085       0.0
Multi-Family with 5+ Units     0.246809  0.246809       0.0
Single-Family Attached         0.014894  0.014894       0.0
Single-Family Detached         0.655319  0.655319       0.0

2023-06-21 15:16:45,836 - INFO -  [[ build_existing_model.heating_fuel ]] 
2023-06-21 15:16:45,840 - INFO - 
              matched     truth  pct_diff
Electricity  0.487234  0.487234      -0.0
Natural Gas  0.502128  0.502128       0.0
Other Fuel   0.002128  0.002128       0.0
Propane      0.008511  0.008511       0.0

2023-06-21 15:16:45,863 - INFO -  [[ build_existing_model.hvac_cooling_type ]] 
2023-06-21 15:16:45,878 - INFO - 
             matched     truth  pct_diff
Central AC  0.653191  0.653191       0.0
Heat Pump   0.121277  0.121277       0.0
None        0.036170  0.036170       0.0
Room AC     0.189362  0.189362       0.0

2023-06-21 15:16:45,887 - INFO -  [[ build_existing_model.tenure ]] 
2023-06-21 15:16:45,901 - INFO - 
         matched     truth  pct_diff
Owner   0.523404  0.523404       0.0
Renter  0.476596  0.476596       0.0

2023-06-21 15:16:45,957 - INFO -  [[ build_existing_model.water_heater_fuel ]] 
2023-06-21 15:16:45,966 - INFO - 
              matched     truth  pct_diff
Electricity  0.542553  0.542553       0.0
Natural Gas  0.455319  0.455319       0.0
Propane      0.002128  0.002128       0.0

2023-06-21 15:16:45,971 - INFO -  [[ build_existing_model.vintage_acs ]] 
2023-06-21 15:16:45,977 - INFO - 
          matched     truth  pct_diff
1940-59  0.304255  0.304255       0.0
1960-79  0.289362  0.289362       0.0
1980-99  0.146809  0.146809       0.0
2000-09  0.072340  0.072340       0.0
2010s    0.031915  0.031915       0.0
<1940    0.155319  0.155319       0.0

2023-06-21 15:16:45,992 - INFO -  [[ build_existing_model.geometry_floor_area_bin ]] 
2023-06-21 15:16:46,005 - INFO - 
            matched     truth  pct_diff
0-1499     0.621277  0.621277       0.0
1500-2499  0.289362  0.289362       0.0
2500-3999  0.076596  0.076596      -0.0
4000+      0.012766  0.012766       0.0

2023-06-21 15:16:46,015 - INFO -  [[ build_existing_model.hvac_heating_type ]] 
2023-06-21 15:16:46,025 - INFO - 
                     matched     truth  pct_diff
Ducted Heat Pump    0.121277  0.121277       0.0
Ducted Heating      0.670213  0.670213       0.0
Non-Ducted Heating  0.208511  0.208511       0.0

2023-06-21 15:16:46,032 - INFO -  [[ build_existing_model.federal_poverty_level ]] 
2023-06-21 15:16:46,037 - INFO - 
           matched     truth  pct_diff
0-100%    0.234043  0.234043       0.0
100-150%  0.142553  0.142553       0.0
150-200%  0.093617  0.093617       0.0
200-300%  0.148936  0.148936       0.0
300-400%  0.110638  0.110638       0.0
400%+     0.270213  0.270213       0.0

2023-06-21 15:16:46,037 - INFO - For unmatched HC:
2023-06-21 15:16:46,037 - INFO - Checking marginals from weight_map of n=1124...
2023-06-21 15:16:46,043 - INFO -  [[ build_existing_model.vacancy_status ]] 
2023-06-21 15:16:46,050 - INFO - 
           matched     truth  pct_diff
Occupied  0.815184  0.812766  0.297481
Vacant    0.184816  0.187234 -1.291336

2023-06-21 15:16:46,063 - INFO - truth vs. matched - per dwelling unit energy:
2023-06-21 15:16:46,073 - INFO - 
                                    matched      truth  pct_diff
energy_use_total_m_btu            71.618456  71.395411  0.312409
fuel_use_electricity_total_m_btu  44.801582  44.823847 -0.049672
fuel_use_fuel_oil_total_m_btu      0.000000   0.000000       NaN
fuel_use_natural_gas_total_m_btu  26.367221  26.128300  0.914415
fuel_use_propane_total_m_btu       0.449676   0.443294  1.439857

2023-06-21 15:16:46,087 - INFO - truth vs. matched - per dwelling unit energy:
2023-06-21 15:16:46,091 - INFO - 
                                                                        matched      truth   pct_diff
build_existing_model.vacancy_status                                                                  
Occupied                            energy_use_total_m_btu            81.266382  80.910937   0.439303
                                    fuel_use_electricity_total_m_btu  50.180931  50.299105  -0.234942
                                    fuel_use_fuel_oil_total_m_btu      0.000000   0.000000        NaN
                                    fuel_use_natural_gas_total_m_btu  30.533840  30.066442   1.554549
                                    fuel_use_propane_total_m_btu       0.551626   0.545414   1.138989
Vacant                              energy_use_total_m_btu            29.063576  30.089375  -3.409174
                                    fuel_use_electricity_total_m_btu  21.074456  21.056250   0.086462
                                    fuel_use_fuel_oil_total_m_btu      0.000000   0.000000        NaN
                                    fuel_use_natural_gas_total_m_btu   7.989180   9.033182 -11.557405
                                    fuel_use_propane_total_m_btu       0.000000   0.000000        NaN

2023-06-21 15:16:46,107 - INFO - truth vs. matched - per dwelling unit energy:
2023-06-21 15:16:46,113 - INFO - 
                                                                matched      truth   pct_diff
build_existing_model.tenure                                                                  
Owner                       energy_use_total_m_btu            88.614461  87.836362   0.885851
                            fuel_use_electricity_total_m_btu  52.096643  51.779472   0.612543
                            fuel_use_fuel_oil_total_m_btu      0.000000   0.000000        NaN
                            fuel_use_natural_gas_total_m_btu  35.801644  35.334894   1.320931
                            fuel_use_propane_total_m_btu       0.716190   0.722024  -0.808008
Renter                      energy_use_total_m_btu            52.953202  53.339723  -0.724641
                            fuel_use_electricity_total_m_btu  36.790042  37.185080  -1.062357
                            fuel_use_fuel_oil_total_m_btu      0.000000   0.000000        NaN
                            fuel_use_natural_gas_total_m_btu  16.006203  16.017487  -0.070445
                            fuel_use_propane_total_m_btu       0.156987   0.137187  14.432417

2023-06-21 15:16:46,126 - INFO - truth vs. matched - per dwelling unit energy:
2023-06-21 15:16:46,133 - INFO - 
                                                                               matched      truth   pct_diff
build_existing_model.federal_poverty_level                                                                  
0-100%                                     energy_use_total_m_btu            55.080961  57.161118  -3.639112
                                           fuel_use_electricity_total_m_btu  36.935148  37.478018  -1.448504
                                           fuel_use_fuel_oil_total_m_btu      0.000000   0.000000        NaN
                                           fuel_use_natural_gas_total_m_btu  17.740513  19.297218  -8.066995
                                           fuel_use_propane_total_m_btu       0.405321   0.385900   5.032730
100-150%                                   energy_use_total_m_btu            71.901074  70.967672   1.315250
                                           fuel_use_electricity_total_m_btu  42.048233  42.823731  -1.810908
                                           fuel_use_fuel_oil_total_m_btu      0.000000   0.000000        NaN
                                           fuel_use_natural_gas_total_m_btu  27.961037  26.267313   6.448027
                                           fuel_use_propane_total_m_btu       1.891854   1.876701   0.807417
150-200%                                   energy_use_total_m_btu            62.042485  61.003386   1.703346
                                           fuel_use_electricity_total_m_btu  43.186303  43.509136  -0.741990
                                           fuel_use_fuel_oil_total_m_btu      0.000000   0.000000        NaN
                                           fuel_use_natural_gas_total_m_btu  18.750733  17.388886   7.831707
                                           fuel_use_propane_total_m_btu       0.105432   0.105432   0.000000
200-300%                                   energy_use_total_m_btu            70.061819  70.062500  -0.000972
                                           fuel_use_electricity_total_m_btu  41.633805  41.831814  -0.473346
                                           fuel_use_fuel_oil_total_m_btu      0.000000   0.000000        NaN
                                           fuel_use_natural_gas_total_m_btu  28.392170  28.171086   0.784790
                                           fuel_use_propane_total_m_btu       0.035883   0.059643 -39.836327
300-400%                                   energy_use_total_m_btu            75.331421  72.320231   4.163690
                                           fuel_use_electricity_total_m_btu  45.871975  43.598750   5.213969
                                           fuel_use_fuel_oil_total_m_btu      0.000000   0.000000        NaN
                                           fuel_use_natural_gas_total_m_btu  29.451810  28.721442   2.542935
                                           fuel_use_propane_total_m_btu       0.007599   0.000000        inf
400%+                                      energy_use_total_m_btu            88.448553  87.906378   0.616764
                                           fuel_use_electricity_total_m_btu  54.934955  54.847811   0.158884
                                           fuel_use_fuel_oil_total_m_btu      0.000000   0.000000        NaN
                                           fuel_use_natural_gas_total_m_btu  33.258030  32.811772   1.360056
                                           fuel_use_propane_total_m_btu       0.255609   0.246819   3.561323

2023-06-21 15:16:46,145 - INFO - >> Database down-selected to 1124 buildings, based on input data of 470 buildings, result outputs to: 
/Users/lliu2/Documents/GitHub/ResStock/euss_cleap/data_/downsampled_buildings_id/euss1_2018_results_up00__downsampled_method1__north_birmingham.csv

