schema_version: '0.3'
os_version: 3.5.1
os_sha: 22e1db7be5
buildstock_directory: ../ # Relative to this file or absolute
project_directory: project_national # Relative to buildstock_directory
output_directory: /projects/abctypol/largeee/test_runs/category_6_20230531/
# weather_files_url: https://data.nrel.gov/system/files/156/BuildStock_TMY3_FIPS.zip
weather_files_path: /shared-projects/buildstock/weather/BuildStock_TMY3_FIPS.zip

sampler:
  type: precomputed
  args:
    sample_file: /projects/abctypol/largeee/test_runs/buildstock_10k_20230525.csv #../buildstock_10k_20230525.csv # relative to file

baseline:
  n_buildings_represented: 136569411 # American Community Survey 2019 5-year, B25001, does not include AK, HI, and territories
  skip_sims: true

eagle:
  n_jobs: 1
  minutes_per_sim: 4
  account: abctypol
  postprocessing:
    time: 20
    n_workers: 1
  sampling:
    time: 5

postprocessing:
  keep_individual_timeseries: false
  aws:
    region_name: us-west-2
    s3:
      bucket: largeee
      prefix: test_runs
    athena:
      glue_service_role: service-role/AWSGlueServiceRole-default
      database_name: largeee_test_runs
      max_crawling_time: 1200

workflow_generator:
  type: residential_hpxml
  args:
    build_existing_model:
      simulation_control_timestep: 60
      simulation_control_run_period_begin_month: 1
      simulation_control_run_period_begin_day_of_month: 1
      simulation_control_run_period_end_month: 12
      simulation_control_run_period_end_day_of_month: 31
      simulation_control_run_period_calendar_year: 2007

    emissions:
      - scenario_name: LRMER_MidCase_15
        type: CO2e
        elec_folder: data/cambium/LRMER_MidCase_15

    utility_bills:
      - scenario_name: Bills

    simulation_output_report:
      timeseries_frequency: monthly
      include_timeseries_total_consumptions: true
      include_timeseries_fuel_consumptions: true
      include_timeseries_end_use_consumptions: true
      include_timeseries_emissions: true
      include_timeseries_total_loads: false

    reporting_measures:
      - measure_dir_name: QOIReport

    server_directory_cleanup:
      retain_in_idf: false
      retain_schedules_csv: false


### -- Upgrades ---
# Category 6:  Heat Pumps with Existing Backup
# To do: costing interpolation from Less for 9.2, 9.5, and 11 HSPF
upgrades:
  - upgrade_name: EnergyStar ducted ASHP w/ existing backup  #also provides SEER 15 cooling measure profile
    # Measure 1
    options:
      #ASHP
      - &ducted_ASHP_EnergyStar_exist_backup_no_shared_ducts
        option: HVAC Heating Efficiency|ASHP, SEER 16, 9.2 HSPF, Separate Backup # same as base option
        apply_logic: &dualfuel_ASHP_no_ducted_furnace_apply_logic
          - HVAC Has Ducts|Yes
          - or:
            - Heating Fuel|Natural Gas
            - Heating Fuel|Propane
            - Heating Fuel|Fuel Oil
          - not:
              or:
                - HVAC Heating Type And Fuel|Natural Gas Fuel Furnace
                - HVAC Heating Type And Fuel|Propane Fuel Furnace
                - HVAC Heating Type And Fuel|Fuel Oil Fuel Furnace
                - HVAC Heating Efficiency|Shared Heating
        costs: &costs_ashp_ducted_SEER_16_9-2_HSPF
        # Source: Custom regression by Brennan Less. Ducted heat pump project costs were regressed on nameplate tons and HSPF,
        # from data described in in Less et al. https://doi.org/10.20357/B7FP4D. 2019$ inflated to 2022$ using 1.12 factor.
        # Ducted ASHP regression n=317. Implicitly includes electrical upgrades and electric backup.
          - value: 3907.01 # for HSPF 9
            multiplier: Fixed (1)
          - value: 155.17
            multiplier: Size, Heating System Primary (kBtu/h)
        lifetime: &lifetime_ducted_ASHP_exist_backup 15

      - &HP_cooling_efficiency
        option: HVAC Cooling Efficiency|Heat Pump
        apply_logic:
          - or:
            - *ducted_ASHP_elec_backup
            - *ductless_MSHP_elec_backup

      - &100_percent_conditioned
        option: HVAC Cooling Partial Space Conditioning|100% Conditioned
        apply_logic:
          - or:
            - *ducted_ASHP_elec_backup
            - *ductless_MSHP_elec_backup

  # Boilers as secondary systems
  # Set secondary boiler fuel type
      - &ng_boiler_secondary_heating_type_fuel
        option: HVAC Secondary Heating Type And Fuel|Natural Gas Boiler
        apply_logic:
          - HVAC Heating Type And Fuel|Natural Gas Boiler
      - &propane_boiler_secondary_heating_type_fuel
        option: HVAC Secondary Heating Type And Fuel|Propane Boiler
        apply_logic:
          - HVAC Heating Type And Fuel|Propane Fuel Boiler
      - &fuel_oil_boiler_secondary_heating_type_fuel
        option: HVAC Secondary Heating Type And Fuel|Fuel Oil Boiler
        apply_logic:
          - HVAC Heating Type And Fuel|Fuel Oil Fuel Boiler
  # Set secondary fuel boiler efficiency levels
      - &secondary_boiler_72
        option: HVAC Secondary Heating Efficiency|Fuel Boiler, 72% AFUE
        apply_logic:
          - HVAC Heating Efficiency|Fuel Boiler, 72% AFUE
      - &secondary_boiler_76
        option: HVAC Secondary Heating Efficiency|Fuel Boiler, 76% AFUE
        apply_logic:
          - HVAC Heating Efficiency|Fuel Boiler, 76% AFUE
      - &secondary_boiler_80
        option: HVAC Secondary Heating Efficiency|Fuel Boiler, 80% AFUE
        apply_logic:
          - HVAC Heating Efficiency|Fuel Boiler, 80% AFUE
      - &secondary_boiler_82
        option: HVAC Secondary Heating Efficiency|Fuel Boiler, 82% AFUE
        apply_logic:
          - HVAC Heating Efficiency|Fuel Boiler, 82% AFUE
      - &secondary_boiler_85
        option: HVAC Secondary Heating Efficiency|Fuel Boiler, 85% AFUE
        apply_logic:
          - HVAC Heating Efficiency|Fuel Boiler, 85% AFUE
      - &secondary_boiler_90
        option: HVAC Secondary Heating Efficiency|Fuel Boiler, 90% AFUE
        apply_logic:
          - HVAC Heating Efficiency|Fuel Boiler, 90% AFUE
      - &secondary_boiler_95
        option: HVAC Secondary Heating Efficiency|Fuel Boiler, 95% AFUE, OAT Reset
        apply_logic:
          - HVAC Heating Efficiency|Fuel Boiler, 95% AFUE, OAT Reset
      - &secondary_boiler_96
        option: HVAC Secondary Heating Efficiency|Fuel Boiler, 96% AFUE
        apply_logic:
          - HVAC Heating Efficiency|Fuel Boiler, 96% AFUE

  # Wall/Floor Furnace as secondary systems
  # Set secondary Wall/Floor Furnace fuel type
      - &ng_wallfloor_furnace_secondary_heating_type_fuel
        option: HVAC Secondary Heating Type And Fuel|Natural Gas Fuel Wall/Floor Furnace
        apply_logic:
          - HVAC Heating Type And Fuel|Natural Gas Fuel Wall/Floor Furnace
      - &propane_wallfloor_furnace_secondary_heating_type_fuel
        option: HVAC Secondary Heating Type And Fuel|Propane Fuel Wall/Floor Furnace
        apply_logic:
          - HVAC Heating Type And Fuel|Propane Fuel Wall/Floor Furnace
      - &fuel_oil_wallfloor_furnace_secondary_heating_type_fuel
        option: HVAC Secondary Heating Type And Fuel|Fuel Oil Fuel Wall/Floor Furnace
        apply_logic:
          - HVAC Heating Type And Fuel|Fuel Oil Fuel Wall/Floor Furnace
  # Set secondary fuel Wall/Floor Furnace efficiency levels
      - &secondary_wallfloor_furnace_60
        option: HVAC Secondary Heating Efficiency|Fuel Wall/Floor Furnace, 60% AFUE
        apply_logic:
          - HVAC Heating Efficiency|Fuel Wall/Floor Furnace, 60% AFUE
      - &secondary_wallfloor_furnace_68
        option: HVAC Secondary Heating Efficiency|Fuel Wall/Floor Furnace, 68% AFUE
        apply_logic:
          - HVAC Heating Efficiency|Fuel Wall/Floor Furnace, 68% AFUE

  - upgrade_name: EnergyStar cold climate ducted ASHP w/ elec backup  #also provides SEER 15 cooling measure profile
    # Measure 2
    options:
      #ASHP
      - &ducted_ASHP_EnergyStarCC_elec_backup
        option: HVAC Heating Efficiency|ASHP, SEER 16, 9.5 HSPF, CCHP # same as base option
        apply_logic: *ducted_ASHP_elec_backup
        costs: &costs_ashp_ducted_SEER_16_9-5_HSPF
        # Source: Custom regression by Brennan Less. Ducted heat pump project costs were regressed on nameplate tons and HSPF,
        # from data described in in Less et al. https://doi.org/10.20357/B7FP4D. 2019$ inflated to 2022$ using 1.12 factor.
        # Ducted ASHP regression n=317. Implicitly includes electrical upgrades and electric backup.
          - value: 3907.01 # for HSPF 9
            multiplier: Fixed (1)
          - value: 155.17
            multiplier: Size, Heating System Primary (kBtu/h)
        lifetime: *lifetime_ducted_ASHP_elec_backup

      - *HP_cooling_efficiency
      - *100_percent_conditioned

      - &cooling_setpoint_no_offset
        option: Cooling Setpoint Has Offset|No
        apply_logic: *ducted_ASHP_elec_backup

      - &cooling_setpoint_offset_magnitude_0
        option: Cooling Setpoint Offset Magnitude|0F
        apply_logic: *ducted_ASHP_elec_backup
      
      - &cooling_setpoint_offset_period_none
        option: Cooling Setpoint Offset Period|None
        apply_logic: *ducted_ASHP_elec_backup

      - &heating_setpoint_no_offset
        option: Heating Setpoint Has Offset|No
        apply_logic: *ducted_ASHP_elec_backup

      - &heating_setpoint_offset_magnitude_0
        option: Heating Setpoint Offset Magnitude|0F
        apply_logic: *ducted_ASHP_elec_backup
      
      - &heating_setpoint_offset_period_none
        option: Heating Setpoint Offset Period|None
        apply_logic: *ducted_ASHP_elec_backup


  - upgrade_name: Higher efficiency ducted ASHP w/ elec backup  #also provides SEER 15 cooling measure profile
    # Measure 3
    options:
      #ASHP
      - &ducted_ASHP_HigherEfficiency_elec_backup
        option: HVAC Heating Efficiency|ASHP, SEER 20, 11 HSPF, CCHP # same as base option
        apply_logic: *ducted_ASHP_elec_backup
        costs: &costs_ashp_ducted_SEER_20_11_HSPF
        # Source: Custom regression by Brennan Less. Ducted heat pump project costs were regressed on nameplate tons and HSPF,
        # from data described in in Less et al. https://doi.org/10.20357/B7FP4D. 2019$ inflated to 2022$ using 1.12 factor.
        # Ducted ASHP regression n=317. Implicitly includes electrical upgrades and electric backup.
          - value: 3907.01 # for HSPF 9
            multiplier: Fixed (1)
          - value: 155.17
            multiplier: Size, Heating System Primary (kBtu/h)
        lifetime: *lifetime_ducted_ASHP_elec_backup

      - *HP_cooling_efficiency
      - *100_percent_conditioned

      - *cooling_setpoint_no_offset
      - *cooling_setpoint_offset_magnitude_0
      - *cooling_setpoint_offset_period_none
      - *heating_setpoint_no_offset
      - *heating_setpoint_offset_magnitude_0
      - *heating_setpoint_offset_period_none

  - upgrade_name: EnergyStar ductless MSHP w/ elec backup  #also provides SEER 15 cooling measure profile
    # Measure 4
    options:
      # MSHP
      - &ductless_MSHP_EnergyStar_elec_backup
        option: HVAC Heating Efficiency|MSHP, SEER 16, 9.2 HSPF # Changed to Max Load
        apply_logic: &ductless_MSHP_elec_backup
          - and:
            - HVAC Has Ducts|No
            - or: &not_MSHP_greater_than_SEER_16_9-2_HSPF
              - not: HVAC Cooling Efficiency|Heat Pump
              - HVAC Heating Efficiency|MSHP, SEER 14.5, 8.2 HSPF
        costs: &costs_mshp_ductless_SEER_16_9-2_HSPF
        # Source: Custom regression by Brennan Less. Ductless heat pump project costs were regressed on nameplate tons,
        # from data described in in Less et al. https://doi.org/10.20357/B7FP4D. 2019$ inflated to 2022$ using 1.12 factor.
        # Ductless MSHP n=173, HSPF median 11, range 9.3–14.2. Implicitly includes multiple zones and electrical upgrades.
        # Regression results in costs that are 15–30% higher than costs from The Heat Pump Store as documented in https://redwoodenergy.net/wp-content/uploads/2021/02/Pocket-Guide-to-All-Electric-Retrofits-of-Single-Family-Homes.pdf 
        # LBNL data were not sufficient to include a relationship between SEER or HSPF and cost, so cost deltas for higher 
        # and lower HSPF were added using the relationship between HSPF and cost for ductless MSHPs in REMDB (https://remdb.nrel.gov/).
          - value: 2472.60
            multiplier: Fixed (1)
          - value: 320.42
            multiplier: Size, Heating System Primary (kBtu/h)
        lifetime: &lifetime_ductless_MSHP_elec_backup 
          15

      - *HP_cooling_efficiency
      - *100_percent_conditioned

  - upgrade_name: EnergyStar cold climate ductless MSHP w/ elec backup  #also provides SEER 15 cooling measure profile
    # Measure 5
    options:
      # MSHP
      - &ductless_MSHP_EnergyStarCC_elec_backup
        option: HVAC Heating Efficiency|MSHP, SEER 16, 9.5 HSPF, CCHP # Changed to Max Load
        apply_logic: *ductless_MSHP_elec_backup
        costs: &costs_mshp_ductless_SEER_15_9-5_HSPF
        # Source: Custom regression by Brennan Less. Ductless heat pump project costs were regressed on nameplate tons,
        # from data described in in Less et al. https://doi.org/10.20357/B7FP4D. 2019$ inflated to 2022$ using 1.12 factor.
        # Ductless MSHP n=173, HSPF median 11, range 9.3–14.2. Implicitly includes multiple zones and electrical upgrades.
        # Regression results in costs that are 15–30% higher than costs from The Heat Pump Store as documented in https://redwoodenergy.net/wp-content/uploads/2021/02/Pocket-Guide-to-All-Electric-Retrofits-of-Single-Family-Homes.pdf 
        # LBNL data were not sufficient to include a relationship between SEER or HSPF and cost, so cost deltas for higher 
        # and lower HSPF were added using the relationship between HSPF and cost for ductless MSHPs in REMDB (https://remdb.nrel.gov/).
          - value: 2472.60
            multiplier: Fixed (1)
          - value: 320.42
            multiplier: Size, Heating System Primary (kBtu/h)
        lifetime: *lifetime_ductless_MSHP_elec_backup 

      - *HP_cooling_efficiency
      - *100_percent_conditioned

      - *cooling_setpoint_no_offset
      - *cooling_setpoint_offset_magnitude_0
      - *cooling_setpoint_offset_period_none
      - *heating_setpoint_no_offset
      - *heating_setpoint_offset_magnitude_0
      - *heating_setpoint_offset_period_none

  - upgrade_name: Higher efficiency ductless MSHP w/ elec backup  #also provides SEER 15 cooling measure profile
    # Measure 6
    options:
      # MSHP
      - &ductless_MSHP_HigherEfficiency_elec_backup
        option: HVAC Heating Efficiency|MSHP, SEER 20, 11 HSPF, CCHP # Changed to Max Load
        apply_logic: *ductless_MSHP_elec_backup
        costs: &costs_mshp_ductless_SEER_20_11_HSPF
        # Source: Custom regression by Brennan Less. Ductless heat pump project costs were regressed on nameplate tons,
        # from data described in in Less et al. https://doi.org/10.20357/B7FP4D. 2019$ inflated to 2022$ using 1.12 factor.
        # Ductless MSHP n=173, HSPF median 11, range 9.3–14.2. Implicitly includes multiple zones and electrical upgrades.
        # Regression results in costs that are 15–30% higher than costs from The Heat Pump Store as documented in https://redwoodenergy.net/wp-content/uploads/2021/02/Pocket-Guide-to-All-Electric-Retrofits-of-Single-Family-Homes.pdf 
        # LBNL data were not sufficient to include a relationship between SEER or HSPF and cost, so cost deltas for higher 
        # and lower HSPF were added using the relationship between HSPF and cost for ductless MSHPs in REMDB (https://remdb.nrel.gov/).
          - value: 2472.60
            multiplier: Fixed (1)
          - value: 320.42
            multiplier: Size, Heating System Primary (kBtu/h)
        lifetime: *lifetime_ductless_MSHP_elec_backup 

      - *HP_cooling_efficiency
      - *100_percent_conditioned

      - *cooling_setpoint_no_offset
      - *cooling_setpoint_offset_magnitude_0
      - *cooling_setpoint_offset_period_none
      - *heating_setpoint_no_offset
      - *heating_setpoint_offset_magnitude_0
      - *heating_setpoint_offset_period_none